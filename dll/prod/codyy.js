!function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=0)}([/*!**********************************!*\
  !*** multi ./src/codyy/index.js ***!
  \**********************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){e.exports=n(/*! E:\workspace\videoMeeting\src\codyy\index.js */1)},/*!****************************!*\
  !*** ./src/codyy/index.js ***!
  \****************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";n(/*! ./tool */2),n(/*! ./coco3.0 */3),n(/*! ./media_device */4),n(/*! ./env_check_plugin */5),n(/*! ./meeting_plugin */6),n(/*! ./publish_plugin */7),n(/*! ./receive_plugin */8),n(/*! ./preview_plugin */9),n(/*! ./wpad/index.min.js */10)},/*!***************************!*\
  !*** ./src/codyy/tool.js ***!
  \***************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){function n(e,t){var n,a,i,o;for(n="",i=e.length,a=0;a<i;a++)o=e.charCodeAt(a),o>=1&&o<=127?n+=e.charAt(a):o>2047?(n+=String.fromCharCode(224|o>>12&15),n+=String.fromCharCode(128|o>>6&63),n+=String.fromCharCode(128|o>>0&63)):(n+=String.fromCharCode(192|o>>6&31),n+=String.fromCharCode(128|o>>0&63));return t.call(null,n)}function i(e){var t,n,a,i,o,r;for(t="",a=e.length,n=0;n<a;)switch((i=e.charCodeAt(n++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(n-1);break;case 12:case 13:o=e.charCodeAt(n++),t+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e.charCodeAt(n++),r=e.charCodeAt(n++),t+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&r)<<0)}return t}var o=null,r=document,c=Object.prototype.toString,l=(Array.prototype.push,Array.prototype.slice),s=window.location,u=(t.call(Object.create(null)),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),d={colgroup:"table",col:"colgroup",thead:"table",tfoot:"table",tbody:"table",tr:"tbody",th:"tr",td:"tr",optgroup:"select",option:"optgroup",legend:"fieldset"},f=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1),p=function e(){if(!(this instanceof e))return new e;this.name="CustomerEvent",this.handles=[]};p.prototype={addCustEvent:function(e,t){for(var n=this,a=0,i=n.handles||[],o=i.length;o--;){var r=i[o],c=r.target;c&&c==n&&(r.events=r.events||{},r.events[e]=r.events[e]||[],r.events[e].push(t),a++)}if(0===a){var r={target:n,events:{}};r.events[e]=[],r.events[e].push(t),i.push(r)}return i},removeCustEvent:function(e){for(var t=this,n=t.handles||[],a=n.length;a--;){var i=n[a],o=i.target;if(o&&o==t){var r=i.events;for(var c in r)c===e&&delete r[c]}}},fire:function(e,t){for(var n=this,a=n.handles||[],i=a.length;i--;){var o=a[i];if(o.target==n){var r=o.events,l=r[e.type];if(!l)return;for(var s=l.length,u=0;u<s;){var d=l[u];if(t)if("[object Array]"===c.call(t))-1!=t.indexOf(d)&&"function"==typeof d&&d.call(n,e.message);else{if("function"!=typeof t)break;t===d&&d.call(n,e.message)}else"function"==typeof d&&d.call(n,e.message);u++}}}}};var v=function(){this.name="Tool",o=document.createElement("DIV")};v.CustomerEvent=p,v.prototype=new p,v.prototype.constructor=v,v.prototype.deepCopy=function(e,t,n){if(e){var t=t||("[object Object]"===c.call(e)?{}:[]);if(c.call(t)!==c.call(e))throw"类型不匹配！";switch(c.call(e)){case"[object Object]":for(var a in e)if(void 0===t[a]||!n){var i=e[a],o=c.call(i);if("[object Object]"===o||"[object Array]"===o){var r="[object Object]"===o?{}:[];"[object Array]"===c.call(t)?t.push(r):t[a]=r,this.deepCopy(i,r)}else"[object Array]"===c.call(t)?t.push(i):t[a]=i}break;case"[object Array]":var l=0,s=e.length;if(s>l){do{if(void 0===t[l]||!n){var i=e[l],o=c.call(i);if("[object Object]"===o||"[object Array]"===o){var r="[object Object]"===o?{}:[];"[object Array]"===c.call(t)?t.push(r):t[a]=r,this.deepCopy(i,r)}else"[object Array]"===c.call(t)?t.push(i):t[a]=i}}while(++l<s)}else void 0!==t[l]&&n||("[object Array]"===c.call(t)?t.push([]):t[a]=[]);break;default:(void 0===t[l]||!n)&&(t=e.valueOf())}return t}},v.prototype.overallCopy=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=e.length,a=this;if(n){var i=c.call(t);return"[object Object]"!=i&&"[object Array]"!=i?t:(e.forEach(function(e){var n=c.call(e);if("[object Object]"==n||"[object Array]"==n)if("[object Object]"===n){if("[object Array]"===l)var i={};for(var o in e){var r=e[o],l=c.call(r);i?i[o]="[object Object]"===l||"[object Array]"===l?a.overallCopy(r):r:t[o]="[object Object]"===l||"[object Array]"===l?a.overallCopy(r):r}i&&t.push(i)}else e.forEach(function(e,n){var i=c.call(e);"[object Object]"===l?t[n]="[object Object]"===i||"[object Array]"===i?a.overallCopy(r):r:"[object Object]"===i||"[object Array]"===i?t.push(a.overallCopy(r)):t.push(r)})}),t)}var i=c.call(t);if("[object Object]"!=i&&"[object Array]"!=i)return t;if("[object Object]"===i){var o={};for(var r in t){var l=t[r],i=c.call(l);o[r]="[object Object]"===i||"[object Array]"===i?a.overallCopy(l):l}}else{var o=[];t.forEach(function(e){var t=c.call(e);"[object Object]"===t||"[object Array]"===t?o.push(a.overallCopy(e)):o.push(e)})}return o},v.prototype.random=function(e){for(var t="",e=e||8;t.length<e;t+=(Math.random()+"").substr(2));return t.substr(0,e)};var h=window.addEventListener?function(e,t,n,a){e&&e.addEventListener(t,n,a||!1)}:function(e,t,n){e&&e.attachEvent(t,n)};if(v.prototype.addEvent=function(e,t,n,a,i){var o=this,l=function(e){if("string"==typeof e){var i=e.trim();if(i.startsWith("#"))h(r.getElementById(i.substring(1,i.length)),t,n,a);else if(i.startsWith("."))for(var o=r.getElementsByClassName(i.substring(1,i.length)),c=o.length;c--;)h(o[c],t,n,a);else for(var o=r.getElementsByTagName(i),c=o.length;c--;)h(o[c],t,n,a)}};if("[object Array]"===c.call(e)||"[object HTMLCollection]"===c.call(e))for(var s=e.length;s--;){var u=e[s];o.isDom(u)?h(u,t,n,a):l(u)}else o.isDom(e)?h(e,t,n,a):l(e)},v.prototype.delEvent=function(t,n,a,i){var o=this,r=Object.prototype.toString,c=function(e){e&&(window.removeEventListener?e.removeEventListener(n,a,i||!1):e.detachEvent(n,a))},l=function(t){if("string"==typeof t){var n=t.trim();if(n.startsWith("#"))c(e.document.getElementById(n.substring(1,n.length)));else if(n.startsWith("."))for(var a=e.document.getElementsByClassName(n.substring(1,n.length)),i=a.length;i--;)c(a[i]);else for(var a=e.document.getElementsByTagName(n),i=a.length;i--;)c(a[i])}};if("[object Array]"===r.call(t))for(var s=t.length;s--;){var u=t[s];o.isDom(u)?c(u):l(u)}else o.isDom(t)?c(t):l(t)},v.prototype.setCookie=function(e,t,n){if(e&&t&&!(isNaN(n)&&n.time&&isNaN(n.time))){var a="",i=(isNaN(n)?n.time:n)||1,o=new Date;if(o.setTime(o.getTime()+i),a=e+"="+escape(t)+";expires="+o.toGMTString(),"[object Object]"===c.call(n))for(var l in n)"time"!==l&&(a+=";"+l+"="+n[l]);r.cookie=a}},v.prototype.getCookie=function(e){if(e){var t="",n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=r.cookie.match(n))?unescape(t[2]):""}},v.prototype.delCookie=function(e){if(e){var t=this.getCookie(e);if(t){var n=new Date;n.setTime(n.getTime()-1),r.cookie=e+"="+escape(t)+";expires="+n.toGMTString()}}},v.prototype.isDom="object"===("undefined"==typeof HTMLElement?"undefined":a(HTMLElement))?function(e){return e instanceof HTMLElement}:function(e){return e&&"object"===(void 0===e?"undefined":a(e))&&(1===e.nodeType&&"string"==typeof e.nodeName||9===e.nodeType&&"#document"===e.nodeName||"Window"===e.constructor.name)},v.prototype.addClass=function(e,t){if(e){if("[object Array]"===c.call(e)||"[object HTMLCollection]"===c.call(e)){var n=0,a=e.length;if(n>=a)return;do{var i=e[n];if(1===i.nodeType){var o=l.call(i.classList,0)||i.className.split(/\s+/);-1===o.indexOf(t)&&(i.className=i.className.trim()+" "+t)}}while(++n<a)}else{if(1!==e.nodeType)return;var o=l.call(e.classList,0)||e.className.split(/\s+/);if(-1!==o.indexOf(t))return;e.className=e.className.trim()+" "+t}return e}},v.prototype.removeClass=function(e,t){if(e){if("[object Array]"===c.call(e)||"[object HTMLCollection]"===c.call(e)){var n=0,a=e.length;if(n>=a)return;do{var i=e[n];1===i.nodeType&&(i.className=i.className.replace(t,"").trim())}while(++n<a)}else{if(1!==e.nodeType)return;e.className=e.className.replace(t,"").trim()}return e}},v.prototype.replaceClass=function(e,t,n){return this.removeClass(e,t),this.addClass(e,n),e},v.prototype.insertHTML=function(e,t,n){if(!e)return!1;if(t=t.toLowerCase(),e.insertAdjacentHTML)e.insertAdjacentHTML(t,n);else{var a=e.ownerDocument.createRange(),i=null;switch(t){case"beforebegin":return a.setStartBefore(e),i=a.createContextualFragment(n),e.parentNode.insertBefore(i,e),e.previousSibling;case"afterbegin":return e.firstChild?(a.setStartBefore(e.firstChild),i=a.createContextualFragment(n),e.insertBefore(i,e.firstChild)):e.innerHTML=n,e.firstChild;case"beforeend":return e.lastChild?(a.setStartAfter(e.lastChild),i=a.createContextualFragment(n),e.appendChild(i)):e.innerHTML=n,e.lastChild;case"afterend":return a.setStartAfter(e),i=a.createContextualFragment(n),e.parentNode.insertBefore(i,e.nextSibling),e.nextSibling}}},v.prototype.buildFlash=function(e,t,n){var n=n||{},a=n.id?n.id:"swf"+this.random(),i=e||document.body,o=(t.indexOf("?")>0?t:t+"?").split("?"),r=[o.shift(),o.join("?")],c=n.wh?[n.wh[0]+"px",n.wh[1]+"px"]:["100%","100%"],l=n.wmode||"transparent",s='<embed \t\t\t\tsrc="'+r[0]+'" \t\t\t\tname="'+a+'" \t\t\t\tpluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" \t\t\t\ttype="application/x-shockwave-flash" \t\t\t\tallownetworking="all" \t\t\t\tallowfullscreen="true" \t\t\t\tallowFullscreenInteractive="true" \t\t\t\tallowscriptaccess="always" \t\t\t\tFlashVars="'+r[1]+'" \t\t\t\twmode="'+l+'" \t\t\t\twidth="'+c[0]+'" \t\t\t\theight="'+c[1]+'">\t\t\t\t</embed>';return s='<object class="FlashPlayer" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=11,0,0,0" width="'+c[0]+'" height="'+c[1]+'" id="'+a+'">\t\t\t\t<param name="wmode" value="'+l+'">\t\t\t\t<param name="allowFullScreen" value="true">\t\t\t\t<param name="AllowNetworking" value="all">\t\t\t\t<param name="allowScriptAccess" value="always">\t\t\t\t<param name="allowFullscreenInteractive" value="true">\t\t\t\t<param name="movie" value="'+r[0]+'">\t\t\t\t<param name="FlashVars" value="'+r[1]+'">'+s+"\t\t\t</object>","string"==n.returnType?s:(i.insertAdjacentHTML("afterBegin",s),document[a])},v.prototype.numberToTime=function(e){var e=e/1e3,t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%3600%60);return"HH:mm:ss".replace("HH",t>=10?t:"0"+t).replace("mm",n>=10?n:"0"+n).replace("ss",a>=10?a:"0"+a)},v.prototype.xml2obj=function(e,t){var e=e.replace(/[<>\/']/g,""),n=e.split(/\s+/),a={},i=n.length,o=0;a[t]={};do{var r=n[o];if(r&&t!==r){var c=r.split("=");a[t][c[0]]=c[1]}}while(++o<i);return a},v.prototype.serialize=function(e){var t=document.forms[e]||document.getElementsByName(e)[0],n=t.elements,a=n.length,i=[],o={},r=0;if(0>=a)return o;do{var c=n[r],l=c.name;-1===i.indexOf(l)&&i.push(l)}while(++r<a);if(0>=(a=i.length))return o;r=0;do{var s=t[i[r]];if(!s.nodeType&&s.length&&0<s.length&&"checkbox"===s[0].type){o[i[r]]="";for(var u in s)s[u].checked&&(o[i[r]]&&(o[i[r]]+=","),o[i[r]]+=s[u].value)}else o[i[r]]=s.value}while(++r<a);return o},v.prototype.copy=function(e,t,n){var a=this;this.addEvent("#"+t,"click",function(){var t=document.getElementById(e);t.select();var i=document.execCommand("Copy");t.selectionEnd=0,n&&n.call(a,i)})},v.prototype.hasClass=function(e,t){var n=e.className,a=!1;return-1!==n.indexOf(t)&&(a=!0),a},v.prototype.pre=function(e){return e.previousElementSibling||e.previousSibling},v.prototype.next=function(e){return e.nextElementSibling||e.nextSibling},v.prototype.preAll=function(e){var t=[],n=e;do{(n=this.pre(n))&&t.push(n)}while(n);return t},v.prototype.nextAll=function(e){var t=[],n=e;do{(n=this.next(n))&&t.push(n)}while(n);return t},v.prototype.siblings=function(e){var t=this.preAll(e),n=this.nextAll(e);return Array.prototype.push.apply(t,n),t},v.prototype.encodeHTML=function(e){return/<([a-zA-Z]+)(?=\s|\/>|>)[\s\S]*>/.test(e)&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e},v.prototype.decodeHTML=function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">")},v.prototype.createElement=function(e){var t=document.createElement("DIV"),n=/^<([a-zA-Z]+)(?=\s|\/>|>)[\s\S]*>$/,e=e.trim();return function(e){if(!n.test(e))try{return r.createElement(e)}catch(e){}var a=d[RegExp.$1.toLowerCase()];if(!a)return t.innerHTML=e,t.removeChild(t.firstChild);var i=0,o=t;do{e="<"+a+">"+e+"</"+a+">",i++}while(a=d[a]);o.innerHTML=e;do{o=o.removeChild(o.firstChild)}while(--i>-1);return o}(e)},v.prototype.encodeBase64=function(e){return n(e,function(e){var t,n,a,i,o,r;for(a=e.length,n=0,t="";n<a;){if(i=255&e.charCodeAt(n++),n==a){t+=u.charAt(i>>2),t+=u.charAt((3&i)<<4),t+="==";break}if(o=e.charCodeAt(n++),n==a){t+=u.charAt(i>>2),t+=u.charAt((3&i)<<4|(240&o)>>4),t+=u.charAt((15&o)<<2),t+="=";break}r=e.charCodeAt(n++),t+=u.charAt(i>>2),t+=u.charAt((3&i)<<4|(240&o)>>4),t+=u.charAt((15&o)<<2|(192&r)>>6),t+=u.charAt(63&r)}return t})},v.prototype.decodeBase64=function(e){var t,n,a,o,r,c,l;for(c=e.length,r=0,l="";r<c;){do{t=f[255&e.charCodeAt(r++)]}while(r<c&&-1==t);if(-1==t)break;do{n=f[255&e.charCodeAt(r++)]}while(r<c&&-1==n);if(-1==n)break;l+=String.fromCharCode(t<<2|(48&n)>>4);do{if(61==(a=255&e.charCodeAt(r++)))return i(l);a=f[a]}while(r<c&&-1==a);if(-1==a)break;l+=String.fromCharCode((15&n)<<4|(60&a)>>2);do{if(61==(o=255&e.charCodeAt(r++)))return i(l);o=f[o]}while(r<c&&-1==o);if(-1==o)break;l+=String.fromCharCode((3&a)<<6|o)}return i(l)},v.prototype.getBestDmsWithoutMessage=function(){var e=[].slice.call(arguments,0),t=e.shift();if("[object Object]"===c.call(t)&&t){var n=t.data,a=n.internal,i=n.external,o=0,r=0,l=0,u=a.length,d=i.length,f={},p={},v=[],h=[],m=[],g=[],b=t.time||30,y=null,w="https:"===s.protocol?"wss://":"ws://",S=e.shift(),C=new RegExp("^(0.)+");y&&clearTimeout(y);var j=function(){for(;m.length;)m.shift().close()},O=function(){for(;g.length;)clearTimeout(g.shift())},N=function(e,t){var n=Date.now(),a=null,i=null,o=!1,r=function(){var r=Date.now(),c=r-n;if(i&&i.close(),a&&clearTimeout(a),o||("in"===t?(v.push(c),f[c]=e.rtmpUrl):(h.push(c),p[c]=e.rtmpUrl)),l++,u+d<=l){var s=f[Math.min.apply(Math,v)]||p[Math.min.apply(Math,h)];S&&S.call(Object.create(null),s?"rtmp://"+s+"/dms":void 0),y&&clearTimeout(y),j(),O()}};i=new WebSocket(w+e.socketUrl),m.push(i),a=setTimeout(function(){o=!0,r()},b),g.push(a),i.onopen=function(){y&&r()}};if(u>o)do{!function(e){C.test(e.socketUrl)?l++:N(e,"in")}(a[o])}while(++o<u);if(d>r)do{!function(e){N(e,"ex")}(i[r])}while(++r<d);y=setTimeout(function(){var e=f[Math.min.apply(Math,v)]||p[Math.min.apply(Math,h)];S&&S.call(Object.create(null),e?"rtmp://"+e+"/dms":void 0),y&&clearTimeout(y),j(),O()},b)}},v.prototype.getBestDmsWithMessage=function(){var e=[].slice.call(arguments,0),t=e.shift();if("[object Object]"===c.call(t)&&t){var n=t.data,a=n.internal,i=n.external,o=0,r=0,l=0,u=a.length,d=i.length,f={},p={},v=[],h=[],m=t.time||3e3,g=null,b=JSON.stringify({method:"ping",data:this.random(t.msgLen||100)}),y=t.times||1,w="https:"===s.protocol?"wss://":"ws://",S=new RegExp("^(0.)+"),C=[],j=[],O=e.shift();g&&clearTimeout(g);var N=function(){for(;C.length;)C.shift().close()},E=function(){for(;j.length;)clearTimeout(j.shift())},x=function(e,t){var n=Date.now(),a=null,i=null,o=0,r=!1,c=function(){var o=Date.now(),c=o-n;if(i&&i.close(),a&&clearTimeout(a),r||("in"===t?(v.push(c),f[c]=e.rtmpUrl):(h.push(c),p[c]=e.rtmpUrl)),l++,u+d<=l){var s=f[Math.min.apply(Math,v)]||p[Math.min.apply(Math,h)];O&&O.call(Object.create(null),s?"rtmp://"+s+"/dms":void 0),g&&clearTimeout(g),N(),E()}};i=new WebSocket(w+e.socketUrl),C.push(i),a=setTimeout(function(){r=!0,c()},m),j.push(a),i.onopen=function(){i.send(b)},i.onmessage=function(e){var e=JSON.parse(e.data);"pingResponse"===e.method&&(o++,y>o?i.send(b):g&&c())}};if(u>o)do{!function(e){S.test(e.socketUrl)?l++:x(e,"in")}(a[o])}while(++o<u);if(d>r)do{!function(e){x(e,"ex")}(i[r])}while(++r<d);g=setTimeout(function(){var e=f[Math.min.apply(Math,v)]||p[Math.min.apply(Math,h)];O&&O.call(Object.create(null),e?"rtmp://"+e+"/dms":void 0),g&&clearTimeout(g),N(),E()},m)}},v.prototype.getBestAmsWithMessage=function(){var e=[].slice.call(arguments,0),t=e.shift();if("[object Object]"===c.call(t)&&t){var n=t.data,a=n.internal,i=n.external,o=0,r=0,l=0,u=a.length,d=i.length,f={},p={},v=[],h=[],m=t.time||3e3,g=null,b=JSON.stringify({method:"ping",data:this.random(t.msgLen||100)}),y=t.times||1,w="https:"===s.protocol?"wss://":"ws://",S=new RegExp("^(0.)+"),C=[],j=[],O=e.shift();g&&clearTimeout(g);var N=function(){for(;C.length;)C.shift().close()},E=function(){for(;j.length;)clearTimeout(j.shift())},x=function(e,t){var n=Date.now(),a=null,i=null,o=0,r=!1,c=function(){var o=Date.now(),c=o-n;if(i&&i.close(),a&&clearTimeout(a),r||("in"===t?(v.push(c),f[c]=e.rtmpUrl):(h.push(c),p[c]=e.rtmpUrl)),l++,u+d<=l){var s=f[Math.min.apply(Math,v)]||p[Math.min.apply(Math,h)];O&&O.call(Object.create(null),s?"http://"+s+"/dms":void 0),g&&clearTimeout(g),N(),E()}};i=new WebSocket(w+e.socketUrl),C.push(i),a=setTimeout(function(){r=!0,c()},m),j.push(a),i.onopen=function(){i.send(b)},i.onmessage=function(e){var e=JSON.parse(e.data);"pingResponse"===e.method&&(o++,y>o?i.send(b):g&&c())}};if(u>o)do{!function(e){S.test(e.socketUrl)?l++:x(e,"in")}(a[o])}while(++o<u);if(d>r)do{!function(e){x(e,"ex")}(i[r])}while(++r<d);g=setTimeout(function(){var e=f[Math.min.apply(Math,v)]||p[Math.min.apply(Math,h)];O&&O.call(Object.create(null),e?"http://"+e+"/dms":void 0),g&&clearTimeout(g),N(),E()},m)}},v.prototype.attr=function(e,t,n){if(e&&t&&this.isDom(e))return void 0===n?e.getAttribute(t):void e.setAttribute(t,n)},v.prototype.removeAttr=function(e,t){e&&t&&this.isDom(e)&&e.removeAttribute(t)},e.tool=new v,String.prototype.trim=String.prototype.trim||function(){this.replace(/(^\s*)|(\s*$)/g,"")},Array.prototype.unique=Array.prototype.unique||function(e){var t=this,n=t.length;if(0!==n){if(void 0===e){var a=new Set(t);t=Array.from(a)}else{var i={},o=0;do{var r=t[o];i[r[e]]?(t.splice(o,1),n=t.length):(i[r[e]]=1,o++)}while(o<n)}return t}},Array.prototype.removeEmpty=function(){var e=this,t=[];return e.map(function(e){void 0!==e&&null!==e&&""!==e&&t.push(e)}),t},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},!e.$jsonp){var m=function(e,t){var n=document.getElementsByTagName("head")[0],a=document.createElement("script");a.id=t,a.src=e,a.charset="utf-8",n.appendChild(a)},g=function(e){var t="jsonp"+Math.floor(1e8*Math.random());return window[t]=function(n){e.call(this,n),window[t]=void 0;try{delete window[t];var a=document.getElementById(t);a.parentNode.removeChild(a)}catch(e){}},t};e.$jsonp=function(e,t,n){if(!e)return!1;n=g(n),e+=e.indexOf("?")>0?"":"?";for(var a in t)e+=(e.endsWith("?")?"":"&")+a+"="+t[a];e+="&callback="+n,m(e,n)}}}(window,function(){return window.duang||void 0})},/*!******************************!*\
  !*** ./src/codyy/coco3.0.js ***!
  \******************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){function n(e){if(!(this instanceof n))return new n(e);var t=this,a=null,i=null,o=e.beatWaitTime||f.beatWaitTime,r=e.beatInterval||f.beatInterval;Object.defineProperty(this,"state",{get:function(){return 0}}),this.run=function(){t.stop(),i=setTimeout(function(){t.ws.send(JSON.stringify({command:"keepAliveMessage"})),a=setTimeout(function(){t.stop(),t.linkBuilder()},o)},r)},this.stop=function(){i&&(clearTimeout(i),i=null),a&&(clearTimeout(a),a=null)}}function a(){function e(t,a){if(!(this instanceof e))return new e(t,a);var i=this,s=null,u=[],p=0,v=!1,h=null,m=new n(a),g=a.linkTimes||f.linkTimes,b=a.linkInterval||f.linkInterval;/^\s*(?:ws:|wss:).*$/.test(t)||(t=("https:"===l?"wss://":"ws://")+t),/\/(?:ws|wss)\/*\s*$/.test(t)||(t+="https:"===l?"/wss":"/ws"),this.handles=[],this._params=a,this.connected=!1,this.users={onlineNum:0};var y=function e(){s=new WebSocket(t),s.onopen=function(){g=a.linkTimes||f.linkTimes,i.ws=s,m.ws=s,i.fire({type:"linkup"}),v=!1,null!=h&&(clearTimeout(h),h=null),s.send(JSON.stringify({command:"online",body:{userToken:a.userToken,clientType:a.clientType||f.clientType,deviceName:a.deviceName||f.deviceName}})),c.push(i),r[a.groupId]=i},s.onmessage=function(e){var t=JSON.parse(e.data),n=t.command,o=t.body;switch(n){case"online":i.connected=!0,i.fire({type:"loginup"}),void 0!=a.groupId&&i.joinGroup(a.groupId);break;case"userGroupAction":"add"===o.action?(w(1,o.userId),o.userId===a.userId&&(a.groupId=o.groupId,u.push(o.groupId)),i.fire({type:"loginNotify",message:{from:o.userId,groupId:o.groupId,clientType:o.clientType,deviceName:o.deviceName}})):(w(-1,o.userId),o.userId===i._params.userId&&(u=[].filter.call(u,function(e){return e!==o.groupId})),i.fire({type:"logoutNotify",message:{from:o.userId,groupId:o.groupId}}));break;case"addGroupResult":i.fire({type:"joinGroup",message:o}),i.getGroupOnline(a.groupId);break;case"kickUser":w(-1,o.userId),i.fire({type:"onKick",message:o});break;case"offline":w(-1,o.userId),i.fire({type:"offline"});break;case"singleChat":"control"===o.message.type?i.fire({type:"callOne",message:o.message.content}):i.fire({type:"recePrivateMsg",message:{from:{userName:o.sendUserName,userId:o.sendUserId,userType:o.sendUserType},data:o.message}});break;case"groupChat":if(o.from===i._params.userId)return;"control"===o.type?i.fire({type:"callAll",message:o.content}):i.fire({type:"recePublicMsg",message:o});break;case"onlineUsers":o.userList.forEach(function(e){w(1,e.userId)}),i.fire({type:"loadUser",message:o.userList});break;case"onlineUsersCount":i.fire({type:"onLoadUserNumber",message:o.activeUserCount});break;case"whitePad":i.fire({type:"onLoadPadData",message:o.data});break;case"control":o.data.from!=i._params.userId&&i.fire({type:d[o.type],message:o.data});break;case"keepAliveMessage":break;default:i.fire({type:"onError",message:o})}m.run()},s.onclose=function(e){if(!e.wasClean&&s.close(),m.stop(),i.connected=!1,!o)switch(delete r[a.groupId],c.splice(c.indexOf(i),1),e.code){case 1015:i.fire({type:"onError",message:{code:0,message:"数字证书验证失败"}});break;case 1e3:break;default:v||(w(-1,a.userId),m.linkBuilder(),i.fire({type:"offline"}),i.fire({type:"logoutNotify",message:{from:a.userId,groupId:a.groupId}}))}},v&&g&&(g--,h&&(clearTimeout(h),h=null),h=setTimeout(function(){s.onopen=null,s.onmessage=null,s.onclose=null,s.readyState!=s.CLOSED&&s.close(),e()},b))};m.linkBuilder=function(){v=!0,y()},Object.defineProperties(this,{sequence:{get:function(){return p++}}}),y(),this.getGroups=function(){return u||[]},this.getLastGroup=function(){return u.length<=0?void 0:u[u.length-1]};var w=function(e,t){i.users[t]?-1===e&&(i.users.onlineNum=i.users.onlineNum+e,delete i.users[t]):1===e&&(i.users.onlineNum=i.users.onlineNum+e,i.users[t]=!0)}}return e.prototype=u,e.prototype.constructor=e,e.prototype.addEvent=u.addCustEvent,e.prototype.removeEvent=u.removeCustEvent,e.prototype.fire=u.fire,e.prototype.joinGroup=function(e){if(void 0!==e){var t=this._params;this.ws.send(JSON.stringify({command:"addGroup",body:{deviceName:t.deviceName||f.deviceName,clientType:t.clientType||f.clientType,groupId:e,userId:t.userId}}))}},e.prototype.kickOut=function(e,t){void 0!==e&&this.ws.send(JSON.stringify({command:"kickUser",body:{groupId:"g"===t?"":t||this.getLastGroup(),userId:e}}))},e.prototype.addPadTab=function(e){var t={command:"control",body:{type:"whitePadAddTab",userType:e.userType||f.userType,data:{from:this._params.userId,tabName:e.tabName||f.tabName}}};e.data&&Object.assign(t.body.data,e.data),e.users&&0<e.users.length?t.body.clientIds=e.users:t.body.groupId=e.groupId||this.getLastGroup(),this.ws.send(JSON.stringify(t))},e.prototype.removePadTab=function(e){var t={command:"control",body:{type:"whitePadRemoveTab",userType:e.userType||f.userType,data:{from:this._params.userId,tabName:e.tabName||"",tabId:e.tabId||""}}};e.data&&Object.assign(t.body.data,e.data),e.users&&0<e.users.length?t.body.clientIds=e.users:t.body.groupId=e.groupId||this.getLastGroup(),this.ws.send(JSON.stringify(t))},e.prototype.focusPadTab=function(e){if(void 0!==e.tabId){var t={command:"control",body:{type:"whitePadChangeTab",userType:e.userType||f.userType,data:{from:this._params.userId,tabName:e.tabName||"",tabId:e.tabId}}};e.users&&0<e.users.length?t.body.clientIds=e.users:t.body.groupId=e.groupId||this.getLastGroup(),this.ws.send(JSON.stringify(t))}},e.prototype.write=function(e){var t=this,n=e.content||e,a=[];if(void 0!==n){var i={command:"whitePad",body:{tabId:e.tabId||0,groupId:e.groupId||this.getLastGroup(),data:[]}};"[object Array]"===toString.call(n)?n.forEach(function(e){var n={sequence:t.sequence,type:e.type||"",content:e.data||e,clientId:t._params.userId};a.push(n)}):a.push({sequence:t.sequence,type:n.type||"",content:n.data||n,clientId:t._params.userId}),[].push.apply(i.body.data,a),this.ws.send(JSON.stringify(i))}},e.prototype.sendMsgToAll=function(e){if(void 0!==e.type&&(e.content||-1!==[0,!1,null].indexOf(e.content))){var t={command:"groupChat",body:{groupId:e.groupId||this.getLastGroup(),message:{type:e.type,content:e.content,from:this._params.userId}}};this.ws.send(JSON.stringify(t))}},e.prototype.sendMsgTo=function(e){if(void 0!==e.userId&&void 0!==e.type&&(e.content||-1!==[0,!1,null].indexOf(e.content))){var t={command:"singleChat",body:{sendUserId:this._params.userId,receivedUserId:e.userId,message:{type:e.type,content:e.content}}};this.ws.send(JSON.stringify(t))}},e.prototype.getGroupOnline=function(e){this.ws.send(JSON.stringify({command:"onlineUsers",body:{groupId:e||this.getLastGroup()}}))},e.prototype.getGroupCount=function(e){this.ws.send(JSON.stringify({command:"groupUserCount",body:{groupId:e||this.getLastGroup()}}))},e.prototype.callOne=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=1<e.length?e:e.shift();if(void 0!==t){var a={command:"singleChat",body:{sendUserId:this._params.userId,receivedUserId:t,message:{type:"control",content:n||{}}}};this.ws.send(JSON.stringify(a))}},e.prototype.callAll=function(){var e=[].slice.call(arguments,0),t=this.getGroups(),n=e.shift();-1===t.indexOf(n)&&((n||-1!=[0,!1,null].indexOf(n))&&e.unshift(n),n=null);var a=1<e.length?e:e.shift(),i=n||this.getLastGroup();if(void 0!==i){var o={command:"groupChat",body:{groupId:i,message:{type:"control",from:this._params.userId,content:a||{}}}};this.ws.send(JSON.stringify(o))}},e.prototype.isOnline=function(e){return!!this.users[e]},{init:function(t,n){if(t&&void 0!==n.userToken&&void 0!==n.userId)return new e(t,n)},get:function(e){if(void 0!==e)return r[e]||c[e]||null}}}var i=e.call(null),o=!1,r={},c=[],l=location.protocol,s=i?i.getModule("Tool").getController("tool"):window.vm&&window.vm.module?window.vm.module.tool:window.tool,u=new s.constructor.CustomerEvent,d={whitePadAddTab:"onPadTabAdd",whitePadRemoveTab:"onPadTabRemove",whitePadChangeTab:"onPadTabFocus"},f={clientType:"client",deviceName:"PC",userType:"all",tabName:"白板",beatInterval:5e3,beatWaitTime:5e3,linkTimes:100,linkInterval:5e3};s.addEvent(window,"beforeunload",function(){o=!0}),n.prototype={constructor:n},i?i.module("Tool",[]).controller("COCO",a):function(){window.vm?function(){vm.module=vm.module||{},vm.module.COCO=a()}():window.COCO=a()}()}(function(){return window.duang||null})},/*!***********************************!*\
  !*** ./src/codyy/media_device.js ***!
  \***********************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){function n(){var e=this,t=Object.assign({});t[e.type]=!0,navigator.mediaDevices.getUserMedia(t).then(function(e){var t=e.getTracks();return t&&t.forEach(function(e){e.stop()}),e.oninactive=function(){},navigator.mediaDevices.enumerateDevices()}).then(function(t){t=t.filter(function(t){var n="communications"!=t.deviceId&&"default"!=t.deviceId&&e.type+"input"===t.kind;return n&&(e.deviceMap[t.label]=t),n}),[].push.apply(e.devices,t),e.status=1}).catch(function(t){e.time--,e.time>0?setTimeout(function(){e.getDevices()},400):e.status=1})}var a=Object.prototype.toString,i=function(){return window.duang||null}(),o=i?i.getModule("Tool").getController("tool"):window.tool,r=new o.constructor.CustomerEvent;r.handles=[];var c={time:5,type:"video",devices:[],deviceMap:{},getDevices:n},l={time:5,type:"audio",devices:[],deviceMap:{},getDevices:n};Object.defineProperty(c,"status",{set:function(e){1===e&&(Object.defineProperty(this,"status",{value:1}),1===l.status&&r.fire({type:"OnReady",message:[].concat.apply([],this.devices,l.devices)}))},get:function(){return 0},configurable:!0}),Object.defineProperty(l,"status",{set:function(e){1===e&&(Object.defineProperty(this,"status",{value:1}),1===c.status&&r.fire({type:"OnReady",message:[].concat.apply([],c.devices,this.devices)}))},get:function(){return 0},configurable:!0}),c.getDevices(),l.getDevices();var s={addEvent:function(e,t){"[object Function]"==a.call(t)&&(r.addCustEvent(e,t),1===l.status&&1===c.status&&t())},getAllMedias:function(){if(l.status&&c.status)return[].concat.apply([],c.devices,l.devices)},getAllVideos:function(){if(c.status)return c.devices},getAllAudios:function(){if(l.status)return l.devices},getVideoByName:function(e){if(c.status)return c.deviceMap[e]},getAudioByName:function(e){return l.deviceMap[e]},getMediaByName:function(e){return c.deviceMap[e]||l.deviceMap[e]}};window.mediaDevice=s}()},/*!***************************************!*\
  !*** ./src/codyy/env_check_plugin.js ***!
  \***************************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){var n=0,a=e.call(Object.create(null)),i=Object.prototype.toString,o=a?a.getModule("Tool").getController("tool"):window.tool,r=("https:"===location.protocol?"wss://localhost:9102":"ws://localhost:9101")+"/envCheck",c={linkCountLimit:3},l=(window.addEventListener,{}),s={},u={Chrome:"谷歌",Firefox:"火狐",Edge:"Edge",MSIE:"IE","360EE":"360",QQBrowser:"QQ",OPR:"opera"},d={OnDetectionCamera:"OnGetCamera",OnCheckDMSIsConnect:"OnCheckStremServer",OnVideoRender:"OnGetVideoInfo",OnAudioRender:"OnGetAudioInfo",OnAudioCheck:"OnCheckMicrophone",OnNativeEnvironmentCheck:"OnCheckEnv",OnBrowserEnvCheck:"OnBrowserEnvCheck",OnError:"OnError"},f={1002:"协议错误",1015:"证书错误"},p=function(){function e(){}function t(){var e=arguments[0],a=e.shift(),r=e.pop();if("[object Function]"===i.call(a)&&void 0===r)return a();if("[object String]"!=i.call(a)||!n[a])throw"no function name";return"[object Function]"!=i.call(r)&&(void 0!=r&&e.push(r),r=null),e.push(function(){r&&r.apply(this,[].slice.call(arguments,0)),o.shift(),o.length>0&&t(o[0])}),n[a]&&n[a].apply(n,e)}var n=this,a=0,o=[];return e.prototype={constructor:e,pip:function(){if(1!==a)return o.push([].slice.call(arguments,0)),this},then:function(){if(1!==a&&-1!==a&&2!==a)return o.push([].slice.call(arguments,0)),this},exec:function(){if(a=1,o.length>0)try{t(o[0])}catch(e){a=-1}}},new e},v=function(){var e=null,t=new o.constructor.CustomerEvent,a=function t(a,i,p){var v=this;return e=new WebSocket(r),v.state=0,++n,e.onopen=function(){n=0,v.state=this.readyState;var t=[].slice.call(arguments,0);i&&i.apply(e,t)},e.onmessage=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=JSON.parse(o.decodeBase64(t.data));if(n.uuid){var a=n.uuid;delete n.uuid,delete n.event,s[a]&&s[a].call(v,n.param||n),delete s[a]}else l[n.event]?l[n.event](n.param):p&&p.call(u,n)},e.onclose=function(e){if(!v.state&&n>=(a.linkCountLimit||c.linkCountLimit)){var o={code:0};return Object.defineProperty(o,"description",{value:"未安装检测插件"}),void u.fireEvent({type:d.OnError,message:o})}if(v.state=this.readyState,1e3!==e.code)switch(e.code){case 1002:case 1015:u.fireEvent({type:d.OnError,message:{code:e.code,message:f[e.code]}});break;default:t.call(v,i,p)}},this},i=function(t){e.send(t)},u=Object.create({addEvent:t.addCustEvent,removeEvent:t.removeCustEvent,fireEvent:t.fire,handles:[],send:i},{init:{writable:!1,configurable:!1,enumerable:!1,value:a}});return u}(),h={compressZip:function(e,t,n){var a={method:"CompressZip",parameter:{srcPath:e,desPath:t}},r=o.random(20);a.uuid=r,n&&"[object Function]"===i.call(n)&&(s[r]=n),v.send(o.encodeBase64(JSON.stringify(a)))},extractZip:function(e,t,n){var a={method:"ExtractZip",parameter:{srcPath:e,desPath:t}},r=o.random(20);a.uuid=r,n&&"[object Function]"===i.call(n)&&(s[r]=n),v.send(o.encodeBase64(JSON.stringify(a)))},permission:function(e,t){var n={method:"Permission",parameter:{path:e}},a=o.random(20);n.uuid=a,t&&"[object Function]"===i.call(t)&&(s[a]=t),v.send(o.encodeBase64(JSON.stringify(n)))},denyPermission:function(e,t){var n={method:"DenyPermission",parameter:{path:e}},a=o.random(20);n.uuid=a,t&&"[object Function]"===i.call(t)&&(s[a]=t),v.send(o.encodeBase64(JSON.stringify(n)))},detectionCamera:function(e){var t={method:"DetectionCamera"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))},checkDMSIsConnect:function(e,t,n){var a={method:"CheckDMSIsConnect",parameter:{dms:e,timeout:t||2e3}},r=o.random(20);a.uuid=r,n&&"[object Function]"===i.call(n)&&(s[r]=n),v.send(o.encodeBase64(JSON.stringify(a)))},videoRenderStop:function(e){var t={method:"VideoRenderStop"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))},videoRenderStart:function(e,t,n){var a={method:"VideoRenderStart",parameter:{windowsHandle:e,cameraName:t}},r=o.random(20);a.uuid=r,n&&"[object Function]"===i.call(n)&&(s[r]=n),v.send(o.encodeBase64(JSON.stringify(a)))},audioRenderStop:function(e){var t={method:"AudioRenderStop"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))},audioRenderStart:function(e,t){var n={method:"AudioRenderStart",param:{audioName:e}},a=o.random(20);n.uuid=a,t&&"[object Function]"===i.call(t)&&(s[a]=t),v.send(o.encodeBase64(JSON.stringify(n)))},audioCheck:function(e){var t={method:"AudioCheck"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))},checkSpeaker:function(e){var t={method:"SpeakerCheck"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))},nativeEnvironmentCheck:function(e){var t={method:"NativeEnvironmentCheck"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))},checkExtensionScreen:function(e){var t={method:"CheckExtensionScreen"},n=o.random(20);t.uuid=n,e&&"[object Function]"===i.call(e)&&(s[n]=e),v.send(o.encodeBase64(JSON.stringify(t)))}},m={init:function(e,t){return v.init(e,t,function(){var e=[].slice.call(arguments),t=e.shift(),n=t.event;n&&this.fireEvent({type:d[n],message:t.param})})},addEvent:function(e,t){void 0!==e&&void 0!==t&&v.addEvent(e,t)},removeEvent:function(e,t){void 0!==e&&v.removeEvent(e,t)},pip:function(){var e=p.call(this);return e.pip.apply(this,[].slice.call(arguments,0)),e},compressZip:function(e,t,n){void 0!==e&&void 0!==t&&h.compressZip(e,t,n)},extractZip:function(e,t,n){void 0!==e&&void 0!==t&&h.extractZip(e,t,n)},permission:function(e,t){void 0!==e&&h.permission(e,t)},removePerission:function(e,t){void 0!==e&&h.denyPermission(e,t)},getCamera:function(e){h.detectionCamera(e)},checkStreamServer:function(){var e=i.call(arguments),t=e.shift(),n=e.pop(),a=e.shift();t&&"[object Function]"!==i.call(t)&&h.checkDMSIsConnect(t,a||2e3,n)},stopVideoRender:function(e){h.videoRenderStop(e)},startVideoRender:function(e,t,n){e&&t&&h.videoRenderStart(e,t,n)},stopAudioRender:function(e){h.audioRenderStop(e)},startAudioRender:function(e,t){e&&h.audioRenderStart(e,t)},checkAudio:function(e){h.audioCheck(e)},checkEnv:function(e){h.nativeEnvironmentCheck(e)},checkBrowserEnv:function(e){var t={plat:navigator.platform,AVStreaming:{},CodyyReceive:{},CodyyTransfer:{},flash:{},PPMeet:{}},n=navigator.userAgent.match(/^\s*.*(chrome|firefox|edge|MSIE|360EE|QQBrowser|OPR)[\/\s]*([\d+\.?]+)*.*$/i);n={name:n[1],version:n[2]||""},Object.defineProperty(n,"description",{get:function(){return u[n.name]}}),[].slice.call(navigator.plugins,0).forEach(function(e){switch(e.name){case"CodyyMultiHD":t.AVStreaming={},t.AVStreaming.name=e.name,t.AVStreaming.version=e.version,Object.defineProperty(t.AVStreaming,"description",{get:function(){return"发送流插件"}});break;case"CodyyReceiveHD":t.CodyyReceive={},t.CodyyReceive.name=e.name,t.CodyyReceive.version=e.version,Object.defineProperty(t.CodyyReceive,"description",{get:function(){return"接收流插件"}});break;case"CodyyTransfer":t.CodyyTransfer={},t.CodyyTransfer.name=e.name,t.CodyyTransfer.version=e.version,Object.defineProperty(t.CodyyTransfer,"description",{get:function(){return"转换插件"}});break;case"PPMEETSR":t.PPMeet={},t.PPMeet.name=e.name,t.PPMeet.version=e.version,Object.defineProperty(t.PPMeet,"description",{get:function(){return"视频会议插件"}});break;case"Shockwave Flash":t.flash={},t.flash.name=e.name,t.flash.version=e.version,Object.defineProperty(t.flash,"description",{get:function(){return"flash"}})}}),t.browser=n,"[object Function]"===i.call(e)&&e(t)},checkExtensionScreen:function(e){h.checkExtensionScreen(e)},checkSpeaker:function(e){h.checkSpeaker(e)}};window.plugin=window.plugin||{},window.plugin.checkEnv=m}(function(){return window.duang||null})},/*!*************************************!*\
  !*** ./src/codyy/meeting_plugin.js ***!
  \*************************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){var n=function(){return window.duang||null}(),a={},i=!1,o="",r=n?n.getModule("Tool").getController("tool"):window.tool,c="https:"===location.protocol?"wss://localhost:9099":"ws://localhost:9098";(window.addEventListener?function(e,t,n,a){e.addEventListener(t,n,a||!1)}:function(e,t,n){e.attachEvent("on"+n,t)})(window,"beforeunload",function(){i=!0});var l={5002:"OnInit",5004:"OnServerRecordStart",5006:"OnServerRecordStop",5010:"OnSetShareVideo",5016:"OnShareVideoTimeChange",5019:"OnServerRecordPause",5020:"OnError",5063:"OnCaptureUpload",5067:"OnShareVideoEnd",5081:"OnLockScreen",5082:"OnUnlockScreen",9999:"OnDisconnect",1e8:"OnStop"};mediaDevice.addEvent("OnReady",function(){mediaDevice.getAllVideos().forEach(function(e){/Codyy\w+\((\d+)\)/.test(e.label)&&"videoinput"===e.kind&&(a[RegExp.$1]=e)})});var s={preview:function(){var e=null,t=null,n={video:{width:{ideal:1280},height:{ideal:720},deviceId:{}}};return{setCamera:function(e){if(e){var t=a[e.match(/Codyy\w+\((\d+)\)/)[1]];t&&(n.video.deviceId={exact:t.deviceId})}},startPlay:function(a){a&&(t=a),t&&(e&&e.getTracks().forEach(function(e){e.stop()}),navigator.mediaDevices.getUserMedia(n).then(function(n){e=n,t.srcObject=n}))},pausePlay:function(){t&&t.pause()},stopPlay:function(){t&&t.pause()}}}()},u=function(){var e=null,t=!1,n=new r.constructor.CustomerEvent,a=function n(a,l){var s=this;t=!1,e=new WebSocket(c),e.onopen=function(){var t=[].slice.call(arguments,0);a&&a.apply(e,t)},e.onmessage=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=r.decodeBase64(t.data);if(/register/g.test(n))return l.call(s,n);try{n=JSON.parse(n)}catch(e){throw e}if("5002"===n.event.toString())return void(o=n.parameter.version);n.uuid||l.call(s,n)},e.onclose=function(){t&&l.call(s,{event:1e8}),i||t||n(null,l)}},l=function(t){e.send(t)},s=function(){t=!0,e.close()};return Object.create({addEvent:n.addCustEvent,removeEvent:n.removeCustEvent,fireEvent:n.fire,handles:[],send:l,stop:s},{init:{writable:!1,configurable:!1,enumerable:!1,value:a}})}(),d=function(e){return{key:"WSMeetingEngine",value:e}},f={init:function(e,t){if(e){var n=this,a={method:5001,parameter:e};u.init(function(){var t={key:"register",value:e.moduleName};u.send(r.encodeBase64(JSON.stringify(t)))},function(e){if(/register/g.test(e))return t&&t.call(n),void u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(a)))));var i=l[e.event||""];i&&this.fireEvent({type:i,message:e.parameter})})}},startServerRecord:function(){var e={method:5003};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},pauseServerRecord:function(){var e={method:5018};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},stopServerRecord:function(){var e={method:5005};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},startShareDesk:function(){var e={method:5007};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},stopShareDesk:function(){var e={method:5008};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},setShareVideo:function(e){if(e){var t={method:5009,parameter:{title:document.title,cameraId:e}};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(t))))),s.preview.setCamera(e)}},startShareVideo:function(e){var t={method:5011};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(t)))))},shareVideoSeek:function(e){if(void 0!==e&&!isNaN(e)){var t={method:5012,parameter:{seek:e}};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(t)))))}},pauseShareVideo:function(){var e={method:5013};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e))))),s.preview.pausePlay()},stopShareVideo:function(){var e={method:5014};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e))))),s.preview.stopPlay()},exitShareVideo:function(){var e={method:5015};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e))))),s.preview.stopPlay()},captureScreen:function(){var e={method:5017};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},quit:function(){var e={method:5021};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},setShareVideoVoice:function(e){var t={method:5057,parameter:{val:e}};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(t)))))},lockScreen:function(e){var t={method:5060,parameter:{val:e}};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(t)))))},unlockScreen:function(){var e={method:5061};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e)))))},addEvent:function(e,t){void 0!==e&&void 0!==t&&u.addEvent(e,t)},removeEvent:function(e){void 0!==e&&u.removeEvent(e)},stop:function(){var e={method:5021};u.send(r.encodeBase64(JSON.stringify(d(JSON.stringify(e))))),u.stop()},get version(){return o}},p={codyyMeeting:f};n?function(){n.module("Tool",[]).directive("CodyyMeeting",["tool"],function(){return f})}():window.plugin=Object.assign(window.plugin||{},p)}()},/*!*************************************!*\
  !*** ./src/codyy/publish_plugin.js ***!
  \*************************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){function n(e,t){var n=this,a=o[e.cameraId||r++],i={video:{width:{ideal:1280},height:{ideal:720},deviceId:{}}};a&&function(){try{i.video.deviceId={exact:a.deviceId},n.stream&&n.stream.getTracks().forEach(function(e){e.stop()}),navigator.mediaDevices.getUserMedia(i).then(function(a){n.stream=a,e.video.onloadstart=function(){var t=20,n=setInterval(function(){e.video.srcObject.getTracks().forEach(function(t){t.onmute||(t.onmute=function(){e.video.load()})}),0==--t&&clearInterval(n)},1e3)},e.video.srcObject=a,"[object Function]"===u.call(t)&&t()}).catch(function(e){})}catch(e){}}()}function a(e,t){if(!this instanceof a)return new a(e);var i=this,o=new d.constructor.CustomerEvent;this.name="AvPublish",this.id=e.id||d.random(10),o.handle=[],e.background&&(e.video.style.background="center contain no-repeat content-box url("+e.background+")"),e.video.setAttribute("autoplay","autoplay"),i.addEvent=o.addCustEvent.bind(o),i.removeEvent=o.removeCustEvent.bind(o);var r=function(){i.stream.getTracks().forEach(function(e){})};n.call(i,e,r),this.setVideoElement=function(t){e.video=t,n.call(i,e,r)},this.shutdown=function(e){try{i.stream&&(i.stream.getTracks().forEach(function(e){e.stop()}),e&&e())}catch(e){}}}var i=null,o={},r=1,c="",l={},s=e.call(Object.create(null)),u=Object.prototype.toString,d=s?s.getModule("Tool").getController("tool"):window.tool,f=("https:"===location.protocol?"wss://localhost:9099":"ws://localhost:9098")+"/publish",p={1:"OnMainChange",2:"OnRateWatch",3:"OnMouseWatch",4:"OnVGAMotionWatch",5:"OnCPUWatch",6:"OnGPUWatch",7:"OnMemoryWatch",8:"OnPacketLostRate",9:"OnBehaviorExplain",10:"OnBehaviorTrack",11:"OnServerRecordStateChange",15:"OnRecordLimit"},v={101:"OnTransVideoOver",103:p,104:"OnRemoteControlKeypress",105:"OnCenterControlKeypress",106:"OnStateMessage",107:"OnFunctionResult",108:"OnConnectResult",6104:"OnRunningExceptionReport"},h={1002:"协议错误",1015:"证书错误"},m=(window.addEventListener,{199:function(e){c=e.version}});mediaDevice.addEvent("OnReady",function(){mediaDevice.getAllVideos().forEach(function(e){/Codyy\w+\((\d+)\)/.test(e.label)&&"videoinput"===e.kind&&(o[RegExp.$1]=e)})});var g=function(){function e(){}function t(){var e=arguments[0],a=e.shift(),o=e.pop();if("[object Function]"===u.call(a)&&void 0===o)return a();if("[object String]"!=u.call(a)||!n[a])throw"no function name";return"[object Function]"!=u.call(o)&&(void 0!=o&&e.push(o),o=null),e.push(function(){o&&o.apply(this,[].slice.call(arguments,0)),i.shift(),i.length>0&&t(i[0])}),n[a]&&n[a].apply(n,e)}var n=this,a=0,i=[];return e.prototype={constructor:e,pip:function(){if(1!==a)return i.push([].slice.call(arguments,0)),this},then:function(){if(1!==a&&-1!==a&&2!==a)return i.push([].slice.call(arguments,0)),this},exec:function(){if(a=1,i.length>0)try{t(i[0])}catch(e){a=-1}}},new e};a.prototype={constructor:a};var b=function(){var e=null,t=new d.constructor.CustomerEvent,n=function t(n,a,o){var r=this;return e=new WebSocket(f),m[9999]=function(){w.initSenderModule(n,function(){var t=[].slice.call(arguments,0);a&&a.apply(e,t)})},e.onopen=function(){r.state=this.readyState,m[9999]()},e.onmessage=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=JSON.parse(d.decodeBase64(t.data));n.uuid?(l[n.uuid]&&l[n.uuid].call(r,n),delete l[n.uuid]):m[n.event]?m[n.event](n.param):o&&o.call(i,n)},e.onclose=function(e){if(r.state=this.readyState,1e3!==e.code)switch(e.code){case 1002:case 1015:i.fireEvent({type:"OnError",message:{code:e.code,message:h[e.code]}});break;default:t.call(r,n,null,o)}},this},a=function(t){e.send(t)},i=Object.create({addEvent:t.addCustEvent,removeEvent:t.removeCustEvent,fireEvent:t.fire,handles:[],send:a},{init:{writable:!1,configurable:!1,enumerable:!1,value:n}});return i}(),y={init:function(e){if(void 0!==e&&e.video)return i=new a(e,b)},getPlugin:function(){return i}},w={initSenderModule:function(e,t){var n={method:1,delayExitTime:e.delayExitTime||0,param:{stitchDeviceName:e.stitchDeviceName||"",resourceDeviceList:e.resourceDeviceList||[],mcuDeviceName:""}},a=d.random(20);n.uuid=a,t&&"[object Function]"===u.call(t)&&(l[a]=t),b.send(d.encodeBase64(JSON.stringify(n)))},setConfig:function(e,t,n){if(e&&t){var a={method:2,param:{key:e,value:JSON.stringify(t)}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))}},setRecord:function(e,t,n,a){if(void 0!==e&&void 0!==t&&!isNaN(e)){var i={method:3,param:{key:e,id:n,value:t,flag:0}},o=d.random(20);i.uuid=o,a&&"[object Function]"===u.call(a)&&(l[o]=a),b.send(d.encodeBase64(JSON.stringify(i)))}},setStream:function(e,t,n,a,i){if(void 0!==e&&void 0!==t&&!isNaN(e)){var o={method:4,param:{key:e,id:n,flag:a,value:t}},r=d.random(20);o.uuid=r,i&&"[object Function]"===u.call(i)&&(l[r]=i),b.send(d.encodeBase64(JSON.stringify(o)))}},setStitchCapture:function(e,t,n,a,i){if(!isNaN(n)&&void 0!==e){var o={method:5,param:{captureInterval:t,captureHeight:n||200,compress:captureCompress,url:e}},r=d.random(20);o.uuid=r,i&&"[object Function]"===u.call(i)&&(l[r]=i),b.send(d.encodeBase64(JSON.stringify(o)))}},setResourceVideoDevice:function(e,t,n){if(void 0!==e&&void 0!==t){var a={method:6,param:{key:e,value:t}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))}},setPPTIndexInfo:function(e,t,n){if(void 0!==e&&void 0!==t){var a={method:7,param:{key:e,value:t}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))}},setTrafficStatistic:function(e,t,n){if(!(e&&isNaN(e)||t&&isNaN(t))){var a={method:8,param:{time:e||3e3,eventInterval:t||3e3}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))}},removeLogoSubtitle:function(e,t,n,a){if(void 0!==t&&void 0!==n){var i={method:9,param:{key:e||1,id:t,value:n}},o=d.random(20);i.uuid=o,a&&"[object Function]"===u.call(a)&&(l[o]=a),b.send(d.encodeBase64(JSON.stringify(i)))}},setMovieHeadTail:function(e,t,n,a){if(void 0!==n){var i={method:10,param:{key:e||1,switch:t||0,file:n}},o=d.random(20);i.uuid=o,a&&"[object Function]"===u.call(a)&&(l[o]=a),b.send(d.encodeBase64(JSON.stringify(i)))}},setDirectorControl:function(e,t,n,a){if(void 0!==e&&void 0!==t){var i={method:11,param:{key:e,id:t,value:n}},o=d.random(20);i.uuid=o,a&&"[object Function]"===u.call(a)&&(l[o]=a),b.send(d.encodeBase64(JSON.stringify(i)))}},setStitchVideo:function(e,t,n,a){if(void 0!==e){var i={method:12,param:{key:e,id:t,value:n}},o=d.random(20);i.uuid=o,a&&"[object Function]"===u.call(a)&&(l[o]=a),b.send(d.encodeBase64(JSON.stringify(i)))}},getSystemInfo:function(e,t,n){var a={method:13,param:{key:e,value:t||""}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))},setUpdatePlugin:function(e,t){var n={method:14,param:{update:1,updaterUrl:e}},a=d.random(20);n.uuid=a,t&&"[object Function]"===u.call(t)&&(l[a]=t),b.send(d.encodeBase64(JSON.stringify(n)))},setProgramState:function(e,t){var n={method:15,param:{key:e}},a=d.random(20);n.uuid=a,t&&"[object Function]"===u.call(t)&&(l[a]=t),b.send(d.encodeBase64(JSON.stringify(n)))},startVNCBBT:function(e,t,n){var a={method:16,param:{key:e,value:t}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))},setBBTControl:function(e,t,n){var a={method:17,param:{key:e,value:t}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))},setRecordState:function(e,t){var n={method:18,param:{state:e}},a=d.random(20);n.uuid=a,t&&"[object Function]"===u.call(t)&&(l[a]=t),b.send(d.encodeBase64(JSON.stringify(n)))},changeWindowSize:function(){},setGeneralFunction:function(e,t,n){var a={method:20,param:{key:e,value:t}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))},setConversationArray:function(e,t){var n={method:21,param:e},a=d.random(20);n.uuid=a,t&&"[object Function]"===u.call(t)&&(l[a]=t),b.send(d.encodeBase64(JSON.stringify(n)))},setServerRecordState:function(e,t){var n={method:22,param:{state:e}},a=d.random(20);n.uuid=a,t&&"[object Function]"===u.call(t)&&(l[a]=t),b.send(d.encodeBase64(JSON.stringify(n)))},setPreview:function(e,t,n){var a={method:23,param:{id:e,value:t}},i=d.random(20);a.uuid=i,n&&"[object Function]"===u.call(n)&&(l[i]=n),b.send(d.encodeBase64(JSON.stringify(a)))}},S={init:function(e,t){if(void 0!==e){return b.init.call(b,e,t,function(){var e=[].slice.call(arguments),t=e.shift(),n=t.param&&t.param.key?v[t.event][t.param.key]:v[t.event];t.param?delete t.param.key:t.param="",n&&this.fireEvent({type:n,message:t.param})})}},get version(){return c},get state(){return b.state},pip:function(){var e=[].slice.call(arguments,0),t=g.call(this);return e.length>0&&t.pip.apply(this,e),t},addEvent:function(e,t){void 0!==e&&void 0!==t&&b.addEvent(e,t)},removeEvent:function(e,t){void 0!==e&&b.removeEvent(e,t)},setDirectorConfig:function(e,t){e&&w.setConfig(1,e,t)},setPublisherConfig:function(e,t){e&&w.setConfig(2,e,t)},setControllerConfig:function(e,t){e&&w.setConfig(3,e,t)},setTransConfig:function(e,t){e&&w.setConfig(4,e,t)},ableRecord:function(){var e=[].slice.call(arguments,0);w.setRecord.apply(w,[].concat.apply([1,1],e))},disableRecord:function(){var e=[].slice.call(arguments,0);w.setRecord.apply(w,[].concat.apply([1,0],e))},setRecordFilePath:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},void 0!==n.path&&w.setRecord(2,n.path,+n.index||0,t)},setRecordFileType:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop(),i={flv:1,mp4:2};"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(3,void 0===n.type?1:i[n.type],n.index||0,t)},setRecordAppending:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(4,void 0===n.appending?1:Number(n.appending),n.index||0,t)},setRecordBitrate:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(5,void 0===n.bitrate?4e3:n.bitrate,n.index||0,t)},setRecordResolution:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(6,void 0===n.resolution?[1920,1080]:n.resolution,n.index||0,t)},setRecordfps:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(7,void 0===n.fps?24:n.fps,n.index||0,t)},setRecordVoiceStaute:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(8,void 0===n.staute?1:n.staute,n.index||0,t)},setRecordEncodeType:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(9,void 0===n.encode?2:n.encode,n.index||0,t)},setRecordFileSize:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(10,void 0===n.size?5242880:n.size,n.index||0,t)},setRecordFileDuration:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setRecord(11,void 0===n.duration?1800:n.duration,n.index||0,t)},unpublishStream:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(1,0,n.index||0,n.direction||12,t)},publishStream:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(1,1,n.index||0,n.direction||12,t)},setStreamName:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},void 0!==n.streamName&&w.setStream(2,n.streamName,n.index||0,n.direction||12,t)},ableServerRecord:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(2,0,n.index||0,n.direction||12,t)},disableServerRecord:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(2,1,n.index||0,n.direction||12,t)},setStreamBitrate:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(4,void 0===n.bitrate?2e3:n.bitrate,n.index||0,n.direction||12,t)},setStreamResolution:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(5,void 0===n.resolution?[1920,1080]:n.resolution,n.index||0,n.direction||12,t)},setStreamfps:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(6,void 0===n.fps?24:n.fps,n.index||0,n.direction||12,t)},setStreamVoiceStaute:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(7,void 0===n.staute?1:n.staute,n.index||0,n.direction||12,t)},setStreamEncodeType:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(8,void 0===n.encode?2:n.encode,n.index||0,n.direction||12,t)},setServerRecordMode:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(9,n.recordMode||0,n.index||0,n.direction||12,t)},setStreamMode:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setStream(10,+(n.streamMode||0),+(n.index||0),+(n.direction||12),t)},changeServiceRecordStream:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},void 0!==n.streamName&&w.setStream(11,{url:n.streamName,append:Number(n.append||1)},n.index||0,n.direction||12,t)},setStitchCapture:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},n.url&&w.setStitchCapture(n.url,n.interval||10,n.height||100,n.compress||100,t)},setDevicefps:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setResourceVideoDevice(1,a,n)},setDeviceResolution:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setResourceVideoDevice(2,a,n)},setTimelineFile:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setPPTIndexInfo(1,a,n)},setClassroomName:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setPPTIndexInfo(2,a,n)},setTrafficStatisticParam:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},w.setTrafficStatistic(isNaN(n.time)?3e3:+n.time,isNaN(n.interval)?3e3:+n.interval,t)},removeLogo:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},void 0!==n.index&&w.removeLogoSubtitle(1,n.id||0,n.index,t)},removeSubtitle:function(){var e=[].slice.call(arguments,0),t=null,n={},a=e.pop();"[object Function]"===u.call(a)&&(t=a,a=null),n=e.shift()||a||{},void 0!==n.index&&w.removeLogoSubtitle(1,n.id||0,n.index,t)},useMovieHead:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setMovieHeadTail(1,1,a,n)},useMovieTail:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setMovieHeadTail(2,1,a,n)},abandonMovieHead:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setMovieHeadTail(1,0,a,n)},abandonMovieTail:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setMovieHeadTail(2,0,a,n)},closerFocus:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(1,a||0,1,n)},fixFocus:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(1,a||0,0,n)},furtherFocus:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(1,a||0,2,n)},minifyFocal:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(2,a||0,1,n)},fixFocal:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(2,a||0,0,n)},largenFocal:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(2,a||0,2,n)},setWheelZoom:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};a.zoom&&!isNaN(a.zoom)&&w.setDirectorControl(3,a.index||0,a.zoom,n)},setCameraUp:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(4,a||0,1,n)},setCameraDowm:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(4,a||0,2,n)},setCameraLeft:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(4,a||0,3,n)},setCameraRight:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(4,a||0,4,n)},setCameraFix:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;w.setDirectorControl(4,a||0,0,n)},setPreset:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};void 0!==a.preset&&w.setDirectorControl(5,a.index||0,a.preset,n)},mouseClickTrack:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};void 0===a.posx||isNaN(a.posx)||void 0===a.posy||isNaN(a.posy)||void 0===a.width||isNaN(a.width)||void 0===a.height||isNaN(a.height)||w.setDirectorControl(6,a.index||0,[a.posx,a.posy,a.width,a.height],n)},setDirectorMode:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;isNaN(a)||w.setDirectorControl(7,0,+a||1,n)},setScreenShiftStyle:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};w.setStitchVideo(1,a.id||0,a.styleIndex||0,n)},setSplitMode:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};w.setStitchVideo(2,a.id||0,Number(!a.mode||isNaN(a.mode)?1:a.mode),n)},setSmallScreenSite:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};w.setStitchVideo(3,a.id||0,a.site||4,n)},setSmallScreenSequence:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};a.list&&w.setStitchVideo(4,a.id||0,a.list,n)},setHighLight:function(){var e=[].slice.call(arguments,0),t=e.pop(),n={left:1,right:2,none:0},a=null;"[object Function]"===u.call(t)&&(a=t,t=null);var i=e.shift()||t||{};w.setStitchVideo(5,i.id||0,n[i.which||"none"],a)},setHighLightCamera:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};w.setStitchVideo(6,+(a.id||0),+(a.index||0),n)},setMainScreenIndex:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||1;w.setStitchVideo(8,0,+a,n)},setExtansionScreenIndex:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a,i=e.shift();a=isNaN(i)?i||t||1:i,w.setStitchVideo(8,200,+a,n)},setCustSplitInfo:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};a.rule&&w.setStitchVideo(9,a.id||0,a.rule,n)},useLogo:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};a.logo&&void 0!==a.logo.id&&(a.logo.switch=1,a.logo.position=a.logo.position||1,w.setStitchVideo(10,+a.id||0,JSON.stringify(a.logo),n))},abandonLogo:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};a.logo&&void 0!==a.logo.id&&(a.logo.switch=0,w.setStitchVideo(10,a.id||0,JSON.stringify(a.logo),n))},useSubtitle:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null,a={switch:1,direction:1,position:1,scrollDirection:0,fontName:"宋体",fontSize:24,italic:!1,underline:!1,bold:!1,fontColor:"1,0,0,0",backgroundColor:"0,0,0,0"};"[object Function]"===u.call(t)&&(n=t,t=null);var i=e.shift()||t||{};if(i.subtitle&&void 0!==i.subtitle.id&&void 0!==i.subtitle.content&&0!==i.subtitle.content.length){var o=Object.assign(a,i.subtitle);o.fontStyle=[Boolean(o.italic),Boolean(o.underline),Boolean(o.bold)],o.fontColor=o.fontColor.split(",").map(function(e){return+e}),o.backgroundColor=o.backgroundColor.split(",").map(function(e){return+e}),w.setStitchVideo(11,i.id||0,JSON.stringify(o),n)}},abandonSubtitle:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};a.subtitle&&void 0!==a.subtitle.id&&(a.subtitle.switch=0,w.setStitchVideo(11,a.id||0,JSON.stringify(a.subtitle),n))},getDiskFreeSpace:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.getSystemInfo(1,a,n)},getRecordFreeTime:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.getSystemInfo(2,a,n)},getRecordTime:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.getSystemInfo(3,a,n)},getMicrophoneValue:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.getSystemInfo(4,void 0,n)},getLoudspeakerValue:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.getSystemInfo(5,void 0,n)},setUpdatePluginUrl:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setUpdatePlugin(1,a,n)},run:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setProgramState(1,n)},stop:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setProgramState(2,n)},stopVNC:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setProgramState(3,n)},openPPT:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setProgramState(4,n)},pausePPT:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setProgramState(5,n)},closePPT:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setProgramState(6,n)},startVNC:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.startVNCBBT(1,a,n)},openBBTBrowser:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.startVNCBBT(2,a,n)},closeBBTBrowser:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setBBTControl(2,0,n)},enlargeBrowser:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setBBTControl(2,1,n)},reduceBrowser:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setBBTControl(2,2,n)},pageUp:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setBBTControl(1,-1,n)},pageDn:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setBBTControl(1,1,n)},startRecord:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setRecordState(2,n)},pauseRecord:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setRecordState(1,n)},stopRecord:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null),w.setRecordState(0,n)},set hasPreview(e){w.setGeneralFunction(1,e)},setVirtualCameraCount:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;isNaN(a)||w.setGeneralFunction(2,a,n)},openSystemFolder:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setGeneralFunction(3,a,n)},setMicrophoneValue:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=0);var a=e.shift()||t;isNaN(a)||w.setGeneralFunction(4,a,n)},setLoudspeakerValue:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=0);var a=e.shift()||t;isNaN(a)||w.setGeneralFunction(5,a,n)},setUserId:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&w.setGeneralFunction(6,a,n)},closeComputer:function(){w.setGeneralFunction(7,1)},restartComputer:function(){w.setGeneralFunction(7,2)},setVolume:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t;void 0!=a&&w.setGeneralFunction(8,a,n)},openExtansionScreen:function(e){w.setGeneralFunction(9,1,e)},closeExtansionScreen:function(e){w.setGeneralFunction(9,0,e)},setDefaultConversation:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};void 0!==a.left&&void 0!==a.right&&w.setConversationArray(a,n)},startServerRecord:function(){var e=[].slice.call(arguments,0),t=e.pop();w.setServerRecordState(2,t)},pauseServerRecord:function(){var e=[].slice.call(arguments,0),t=e.pop();w.setServerRecordState(1,t)},stopServerRecord:function(){var e=[].slice.call(arguments,0),t=e.pop();w.setServerRecordState(0,t)},setPreview:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;"[object Function]"===u.call(t)&&(n=t,t=null);var a=e.shift()||t||{};w.setConversationArray(a.index||0,a.name,n)}},C={wsPublish:S,avPublish:y};s?function(){s.module("Tool",[]).directive("PublishPlugin",["tool"],function(){return C})}():window.plugin=Object.assign(window.plugin||{},C)}(function(){return window.duang||null})},/*!*************************************!*\
  !*** ./src/codyy/receive_plugin.js ***!
  \*************************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){function n(e,t){var n=this,a=c[e.cameraId||l++],i={video:{width:{ideal:1280},height:{ideal:720},deviceId:{}}};a&&function(){try{i.video.deviceId={exact:a.deviceId},n.stream&&n.stream.getTracks().forEach(function(e){e.stop()}),navigator.mediaDevices.getUserMedia(i).then(function(a){n.stream=a,e.video.onloadstart=function(){var t=20,n=setInterval(function(){e.video.srcObject.getTracks().forEach(function(t){t.onmute||(t.onmute=function(){e.video.load()})}),0==--t&&clearInterval(n)},1e3)},e.video.srcObject=a,"[object Function]"===f.call(t)&&t()})}catch(e){}}()}function a(e,t){if(!this instanceof a)return new a(e);this.name="AvReceive";var i=this,o=function(){i.stream.getTracks().forEach(function(e){})};this.id=e.id||p.random(10),this.taskList=[],n.call(i,e,o),this.addEvent=v.addCustEvent,this.removeEvent=v.removeCustEvent,this.fireEvent=v.fire,this.handles=[],e.background&&(e.video.style.background="center contain no-repeat content-box url("+e.background+")"),e.video.setAttribute("autoplay","autoplay"),this.setVideoElement=function(t){e.video=t,n.call(i,e,o)},this.shutdown=function(e){try{i.stream&&(i.stream.getTracks().forEach(function(e){e.stop()}),e&&e())}catch(e){}}}var i=[],o={},r={},c={},l=1,s="",u={},d=e.call(Object.create(null)),f=Object.prototype.toString,p=d?d.getModule("Tool").getController("tool"):window.tool,v=new p.constructor.CustomerEvent,h=("https:"===location.protocol?"wss://localhost:9099":"ws://localhost:9098")+"/receive",m={1:"OnCPUWatch",2:"OnGPUWatch",3:"OnMemoryWatch"},g={1101:"OnRateWatch",1102:"OnDisConnect",1103:"OnFunctionResult",1104:"OnStateMessage",1105:m,1106:"OnStreamResolution"},b={1002:"协议错误",1015:"证书错误"},y=(window.addEventListener,{1999:function(e){s=e.version}});mediaDevice.addEvent("OnReady",function(){mediaDevice.getAllVideos().forEach(function(e){/Codyy\w+\((\d+)\)/.test(e.label)&&"videoinput"===e.kind&&(c[RegExp.$1]=e)})});var w=function(){function e(){}function t(){var e=arguments[0],a=e.shift(),o=e.pop();if("[object Function]"===f.call(a)&&void 0===o)return a();if("[object String]"!=f.call(a)||!n[a])throw"no function name";return"[object Function]"!=f.call(o)&&(o&&e.push(o),o=null),e.push(function(){o&&o.apply(this,[].slice.call(arguments,0)),i.shift(),i.length>0&&t(i[0])}),n[a]&&n[a].apply(n,e)}var n=this,a=0,i=[];return e.prototype={constructor:e,pip:function(){if(1!==a)return i.push([].slice.call(arguments,0)),this},then:function(){if(1!==a&&-1!==a&&2!==a)return i.push([].slice.call(arguments,0)),this},exec:function(){if(a=1,i.length>0)try{t(i[0])}catch(e){a=-1}}},new e};a.prototype={constructor:a,pip:function(){var e=[].slice.call(arguments,0),t=w.call(this);return e.length>0&&t.pip.apply(this,e),t},ableRecord:function(e){C.setReceiveRecord(1,this.deviceName,1,e)},disableRecord:function(e){C.setReceiveRecord(1,this.deviceName,0,e)},setRecordFileType:function(){var e=[].slice.call(arguments,0),t=e.pop(),n={flv:1,mp4:2},a=null;t&&"[object Function]"===f.call(t)&&(a=t,t=null);var i=e.shift()||t||"flv";C.setReceiveRecord(2,this.deviceName,n[i],a)},setRecordAppending:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t||1;C.setReceiveRecord(3,this.deviceName,Number(a),n)},startRecord:function(e){C.setReceiveRecord(4,this.deviceName,2,e)},paruseRecord:function(e){C.setReceiveRecord(4,this.deviceName,1,e)},stopRecord:function(e){C.setReceiveRecord(4,this.deviceName,0,e)},setRecordFileName:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t;a&&C.setReceiveRecord(5,this.deviceName,a,n)},setRecordType:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t||2;C.setReceiveRecord(6,this.deviceName,a,n)},setStreamName:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t;void 0!==a&&C.setReceiveStream(1,this.deviceName,a,n)},setButterTime:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t;C.setReceiveStream(2,this.deviceName,isNaN(a)?0:a,n)},setReceiveType:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift();a=void 0===a?t||3:a,C.setReceiveStream(3,this.deviceName,a,n)},setEncodeType:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t||1;C.setReceiveStream(4,this.deviceName,a,n)},setShareMemoryName:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t;void 0!==a&&C.setReceiveStream(5,this.deviceName,a,n)},setTrafficStatisticParam:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t||{}||1;C.setTrafficStatistic(this.deviceName,isNaN(a.time)?3e3:+a.time,isNaN(a.interval)?3e3:+a.interval,n)},run:function(e){C.setProgramState(this.deviceName,1,e)},stop:function(e){C.setProgramState(this.deviceName,2,e)},setMemoryResolution:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t||{};C.setMemoryResolution(this.deviceName,isNaN(a.width)?1920:a.width,isNaN(a.height)?1080:a.height,n)},useExtendScreen:function(e){C.setRenderMode(this.deviceName,0,e)},setFastPlayParam:function(){var e=[].slice.call(arguments,0),t=e.pop(),n=null;t&&"[object Function]"===f.call(t)&&(n=t,t=null);var a=e.shift()||t||{};void 0!==a.switch&&void 0!==a.max&&void 0!==a.time&&C.setMemoryResolution(a.switch,a.max,a.time,n)}};var S=function(){var e=null,t=function t(n,i,o){var r=this;e=new WebSocket(h),y[9999]=function(){C.initReceiveModule(n,function(){var t=[].slice.call(arguments,0);i&&i.apply(e,t)})},e.onopen=function(){r.state=this.readyState,y[9999]()},e.onmessage=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=JSON.parse(p.decodeBase64(t.data));n.uuid?(u[n.uuid]&&u[n.uuid].call(r,n),delete u[n.uuid]):y[n.event]?y[n.event](n.param):o&&o.call(a,n)},e.onclose=function(e){if(r.state=this.readyState,1e3!==e.code)switch(e.code){case 1002:case 1015:a.fireEvent({type:"OnError",message:{code:e.code,message:b[e.code]}});break;default:t.call(r,n,null,o)}}},n=function(t){e.send(t)},a=Object.create({addEvent:v.addCustEvent,removeEvent:v.removeCustEvent,fireEvent:v.fire,handles:[],send:n},{init:{writable:!1,configurable:!1,enumerable:!1,value:t}});return a}(),C={initReceiveModule:function(e,t){var n=e.deviceList||[];if(!(n.length<=0)){var a={method:1001,delayExitTime:e.delayExitTime||0,param:{deviceList:n}},i=p.random(20);a.uuid=i,t&&"[object Function]"===f.call(t)&&(u[i]=t),S.send(p.encodeBase64(JSON.stringify(a)))}},setReceiveRecord:function(e,t,n,a){var i={method:1002,param:{key:e,deviceName:t,value:n}},o=p.random(20);i.uuid=o,a&&"[object Function]"===f.call(a)&&(u[o]=a),S.send(p.encodeBase64(JSON.stringify(i)))},setReceiveStream:function(e,t,n,a){var i={method:1003,param:{key:e,deviceName:t,value:n}},o=p.random(20);i.uuid=o,a&&"[object Function]"===f.call(a)&&(u[o]=a),S.send(p.encodeBase64(JSON.stringify(i)))},setTrafficStatistic:function(e,t,n,a){var i={method:1004,param:{deviceName:e,time:t,eventInterval:n}},o=p.random(20);i.uuid=o,a&&"[object Function]"===f.call(a)&&(u[o]=a),S.send(p.encodeBase64(JSON.stringify(i)))},setProgramState:function(e,t,n){var a={method:1005,param:{key:t,deviceName:e}},i=p.random(20);a.uuid=i,n&&"[object Function]"===f.call(n)&&(u[i]=n),S.send(p.encodeBase64(JSON.stringify(a)))},setMemoryResolution:function(e,t,n,a){var i={method:1007,param:{deviceName:e,width:t,height:n}},o=p.random(20);i.uuid=o,a&&"[object Function]"===f.call(a)&&(u[o]=a),S.send(p.encodeBase64(JSON.stringify(i)))},setRenderMode:function(e,t,n){var a={method:1008,param:{deviceName:e,mode:t}},i=p.random(20);a.uuid=i,n&&"[object Function]"===f.call(n)&&(u[i]=n),S.send(p.encodeBase64(JSON.stringify(a)))},setFastPlayParam:function(e,t,n,a){var i={method:1009,param:{fastPlaySwitch:e,thresholdValue:t,keepThresholdTime:n}},o=p.random(20);i.uuid=o,a&&"[object Function]"===f.call(a)&&(u[o]=a),S.send(p.encodeBase64(JSON.stringify(i)))}},j={init:function(e){if(void 0!==e&&e.video){var t=new a(e,S);return i.push(t),t.deviceName=e.deviceName||"",void 0!==e.id&&(o[e.id]=t),void 0!==e.deviceName&&(r[t.deviceName]=t),t}},getPluginByIndex:function(e){return e=e||0,i[e]},getPluginById:function(e){if(void 0!==e)return o[e]}},O={init:function(e,t){if(void 0!==e){return S.init.call(S,e,t,function(){var e=[].slice.call(arguments),t=e.shift(),n=t.param&&t.param.key?g[t.event][t.param.key]:g[t.event];if(t.param?delete t.param.key:t.param="",n)if(t.param.deviceName){var a=r[t.param.deviceName];a&&a.fireEvent({type:n,message:t.param})}else this.fireEvent({type:n,message:t.param})})}},get state(){return S.state},addEvent:function(e,t){void 0!==e&&void 0!==t&&S.addEvent(e,t)},removeEvent:function(e,t){void 0!==e&&S.removeEvent(e,t)},get version(){return s}},N={wsReceive:O,avReceive:j};d?function(){d.module("Tool",[]).directive("ReceivePlugin",["tool"],function(){return N})}():window.plugin=Object.assign(window.plugin||{},N)}(function(){return window.duang||null})},/*!*************************************!*\
  !*** ./src/codyy/preview_plugin.js ***!
  \*************************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";!function(e,t){function n(){if(!this instanceof n)return new n;this.name="PreviewPlugin"}var a={},i={},o={},r={},c=e.call(Object.create(null)),l=Object.prototype.toString,s=c?c.getModule("Tool").getController("tool"):window.tool,u=("https:"===location.protocol?"wss://localhost:9099":"ws://localhost:9098")+"/preview",d={1:"OnCameraBack",2:"OnMicrophoneBack",3:"OnLoudSpeakerBack",4:"OnDiscreteGraphicsCard",5:"OnIntegratedGraphicsCard",3e3:"OnRegister"},f={3100:d,3101:"OnSelectDevice",3102:d,9999:"OnDisconnect",1e8:"OnStop"},p={1002:"协议错误",1015:"证书错误"},v={},h=(window.addEventListener,function(){function e(){}function t(){var e=arguments[0],a=e.shift(),o=e.pop();if("[object String]"!=l.call(a)||!n[a])throw"no function name";return"[object Function]"!=l.call(o)&&(o&&e.push(o),o=null),e.push(function(){o&&o.apply(this,[].slice.call(arguments,0)),i.shift(),i.length>0&&t(i[0])}),n[a]&&n[a].apply(n,e)}var n=this,a=0,i=[];return e.prototype={constructor:e,pip:function(){if(1!==a)return i.push([].slice.call(arguments,0)),this},then:function(){if(1!==a&&-1!==a&&2!==a)return i.push([].slice.call(arguments,0)),this},exec:function(){if(a=1,i.length>0)try{t(i[0])}catch(e){a=-1}}},new e});mediaDevice.addEvent("OnReady",function(){mediaDevice.getAllVideos().forEach(function(e){/Codyy\w+\((\d+)\)/.test(e.label)&&"videoinput"===e.kind&&(i[RegExp.$1]=e)})});var m=function(){var e=null,t=new s.constructor.CustomerEvent,n=function t(n,a){var i=this;e=new WebSocket(u);var c=function(){var e={method:3e3};m.send(s.encodeBase64(JSON.stringify(e)))};return e.onopen=function(){var t=[].slice.call(arguments,0);c(),n&&n.apply(e,t)},e.onmessage=function(){var e=[].slice.call(arguments,0),t=e.shift(),n=JSON.parse(s.decodeBase64(t.data));n.uuid?(r[n.uuid]&&r[n.uuid].call(i,n),delete r[n.uuid]):v[n.event]?v[n.event](n.param):a&&a.call(o,n)},e.onclose=function(e){if(i.state=this.readyState,1e3===e.code)return a.call(o,{event:1e8});switch(e.code){case 1002:case 1015:o.fireEvent({type:"OnError",message:{code:e.code,message:p[e.code]}});break;default:t.call(i,null,a)}},this},a=function(t){e.send(t)},i=function(){e.close()},o=Object.create({addEvent:t.addCustEvent,removeEvent:t.removeCustEvent,fireEvent:t.fire,handles:[],send:a,stop:i},{init:{writable:!1,configurable:!1,enumerable:!1,value:n}});return o.addEvent("OnDisconnect",function(){initPreviewModule()}),o}();n.prototype={constructor:n,pip:function(){var e=h.call(this);return e.pip.apply(this,[].slice.call(arguments,0)),e},getCameras:function(){var e={method:3001,param:{key:1}};m.send(s.encodeBase64(JSON.stringify(e)))},getMicrophones:function(){var e={method:3001,param:{key:2}};m.send(s.encodeBase64(JSON.stringify(e)))},getLouderspeakers:function(){var e={method:3001,param:{key:3}};m.send(s.encodeBase64(JSON.stringify(e)))},getDiscreteGraphics:function(){var e={method:3001,param:{key:4}};m.send(s.encodeBase64(JSON.stringify(e)))},selectDevice:function(e){if(e){var t={method:3002,param:e};m.send(s.encodeBase64(JSON.stringify(t)))}},runView:function(e,t){if(void 0!==e&&t){var n=o[e],a=i[e];t.setAttribute("autoplay","autoplay");var r={audio:!1,video:{width:{ideal:1280},height:{ideal:720},deviceId:{}}};a&&function(){try{r.video.deviceId={exact:a.deviceId},n&&(n.getTracks().forEach(function(e){e.stop()}),delete o[e]),navigator.mediaDevices.getUserMedia(r).then(function(n){o[e]=n,t.srcObject=n})}catch(e){}}()}},stop:function(){m.stop()}};var g={init:function(e){return this.addEvent("OnRegister",e),m.init.call(m,null,function(){var e=[].slice.call(arguments),t=e.shift(),n=t.param&&t.param.key?f[t.event][t.param.key]:f[t.event];t.param?delete t.param.key:t.param="",n&&this.fireEvent({type:n,message:t.param})})},addEvent:function(e,t){void 0!==e&&void 0!==t&&m.addEvent(e,t)},removeEvent:function(e){void 0!==e&&m.removeEvent(e)},get version(){return previewVersion}};a={wsPreview:g,avPreview:{init:function(){return new n}}},c?function(){c.module("Tool",[]).directive("PreviewPlugin",["tool"],function(){return a})}():window.plugin=Object.assign(window.plugin||{},a)}(function(){return window.duang?window.duang:null})},/*!*************************************!*\
  !*** ./src/codyy/wpad/index.min.js ***!
  \*************************************/
/*! dynamic exports provided */
/*! all exports used */
function(e,t,n){"use strict";var a,a;!function e(t,n,i){function o(c,l){if(!n[c]){if(!t[c]){var s="function"==typeof a&&a;if(!l&&s)return a(c,!0);if(r)return r(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[c]={exports:{}};t[c][0].call(d.exports,function(e){return o(t[c][1][e]||e)},d,d.exports,e,t,n,i)}return n[c].exports}for(var r="function"==typeof a&&a,c=0;c<i.length;c++)o(i[c]);return o}({1:[function(e,t,n){!function(){function e(e){this.name=e.name||"Eraser",this.interimBuffer=[],this.buffer=[]}var t={circular:0,quadrate:1},n=null,a=null;e.prototype={constructor:e,active:function(){},mouseRender:function(e){var a=this;e={type:"eraser",data:[e.x,e.y,a.params.eraserSize],mode:t[a.current.name],from:a.params.id,width:a.mainCanvas.offsetWidth,height:a.mainCanvas.offsetHeight},n=e,a.mouseRender.call(a,e)},largen:function(){var e=this,t=e.params.eraserSize,a=e.mainCanvas.clientWidth,i=e.mainCanvas.clientHeight;t++,e.params.eraserSize=Math.min.apply(Math,[t,a,i]),n.data[2]=e.params.eraserSize,e.mouseRender.call(e,n)},lesser:function(){var e=this,t=e.params.eraserSize;t--,e.params.eraserSize=Math.max.apply(Math,[5,t]),n.data[2]=e.params.eraserSize,e.mouseRender.call(e,n)},bufferRender:function(e,n){if(e){var i=this,o={type:"eraser",data:[],status:1,origin:!0,mode:t[i.current.name],from:i.params.id,width:i.mainCanvas.offsetWidth,height:i.mainCanvas.offsetHeight};!n&&a?(e.ex=a.x,e.ey=a.y):(e.ex=e.x,e.ey=e.y),e.size=i.params.eraserSize,o.data.push(e),i.render(o),a=e}},render:function(){},destory:function(){this.current.mouseRender.call(this,{x:-1,y:-1})}};var i=window.vm||{};i.module=i.module||{},i.module.eraser=e,window.vm=i}()},{}],2:[function(e,t,n){!function(){function e(e){this.name=e.name||"Ferula",this.buffer=[]}e.prototype={constructor:e,active:function(){},mouseRender:function(e){var t=this;e={type:"ferula",data:[e.x,e.y],from:t.params.id,width:t.mainCanvas.offsetWidth,height:t.mainCanvas.offsetHeight},t.mouseRender.call(t,e)},destory:function(){this.current.mouseRender.call(this,{x:-1,y:-1})}};var t=window.vm||{};t.module=t.module||{},t.module.ferula=e,window.vm=t}()},{}],3:[function(e,t,n){!function(){function e(e){this.name=e.name||"Image",this.interimBuffer=[],this.buffer=[]}e.prototype={constructor:e,active:function(){},renderBuffer:function(e){var t=this;e={type:"image",data:[e],status:0,origin:!0,from:t.params.id,width:t.mainCanvas.offsetWidth,height:t.mainCanvas.offsetHeight},t.toolbarMap.image.interimBuffer.push(e)},render:function(e){if(e){var t=this,n=t.toolbarMap.image.interimBuffer.shift();if(n)do{n.status=1,n.data=[].concat.apply(n.data,e),t.toolbarMap.image.buffer.push(n),t.render(n),n=t.toolbarMap.image.interimBuffer.shift()}while(n)}},destory:function(){}};var t=window.vm||{};t.module=t.module||{},t.module.image=e,window.vm=t}()},{}],4:[function(e,t,n){!function(){function e(t){if(!this instanceof e)return new e(t);var n=this,i=1,o=t.that,r=x.splitPage(t.data),c=r.length,l=t.tabId,s=t.show||!1,u=document.createElement("DIV"),d=o.params.wrap.getElementsByClassName("split-page-wrap")[0];u.innerHTML=j.replace(/@TOTAL@/g,c);var f=u.removeChild(u.firstElementChild||u.firstChild),v=f.getElementsByClassName("pre-page-btn")[0],h=f.getElementsByClassName("next-page-btn")[0],m=f.getElementsByClassName("go-page-btn")[0],g=f.getElementsByClassName("page-number-input")[0];N.addEvent(v,p.click,function(){o.params.disable||i<=1||n.pre()}),N.addEvent(h,p.click,function(){o.params.disable||i>=c||n.next()}),N.addEvent(m,p.click,function(){if(!o.params.disable){var e=g.value;n.go(e,function(){e=g.value,o.params.onPageTurn&&o.params.onPageTurn(l,e,r[e-1][0])})}}),N.addEvent(g,"input",function(){/^\s*([0-9]+).*\s*$/.test(this.value)?this.value=RegExp.$1:this.value=i}),N.addEvent(g,"keypress",function(){var e=[].slice.call(arguments,0),t=window.event||e[0];if(13===t.keyCode||13===t.which){var a=g.value;n.go(a,function(){a=g.value,o.params.onPageTurn&&o.params.onPageTurn(l,a,r[a-1][0])})}}),this.pre=function(){i--,this.go(i,function(){o.params.onPageTurn&&o.params.onPageTurn(l,i,r[i-1][0])})};var b=function e(t,n,i){var c=r[t-1];"[object Array]"===a.call(c)?c.some(function(a,r){if(!(r<n)){var l=!1;return"file"===a.type?(l=!0,x.render.call(o,a,function(){c.length-1<=r?i&&i():e(t,++r,i)})):(x.render.call(o,a),c.length-1<=r&&i&&i()),l}}):x.render.call(o,c,i)};this.go=function(e,t){switch(b(e=(e=e<=1?1:e)>=c?c:e,0,function(){"[object Function]"===a.call(t)&&t()}),i=e,g.value=e,!0){case i<=1&&i<c:N.addClass(v,"no"),N.removeClass(h,"no");break;case i>1&&i>=c:N.removeClass(v,"no"),N.addClass(h,"no");break;default:N.removeClass(v,"no"),N.removeClass(h,"no")}},this.next=function(){i++,this.go(i,function(){o.params.onPageTurn&&o.params.onPageTurn(l,i,r[i-1][0])})},this.show=function(){if(d.innerHTML="",r.length>1)switch(d.appendChild(f),o.params.splitpageLayout){case"left":d.style.left="10px";break;case"center":d.style.left=(d.parentNode.clientWidth-d.offsetWidth)/2+"px";break;default:d.style.right="10px"}this.go(i)},this.hide=function(){o.tab.getActive().page==n&&r.length>1&&d.removeChild(f)},this.getPageNumber=function(){return i},this.empower=function(){g.removeAttribute("readonly")},this.disable=function(){g.setAttribute("readonly","readonly")},r.forEach(function(e,n){"[object String]"===a.call(e)&&(r[n]=[{data:[e,0,0],pageNumber:n+1,width:o.mainCanvas.offsetWidth,height:o.mainCanvas.offsetHeight,status:1,type:"file",from:t.from}])}),this.push=function(e,t){var n=o.tab.getActive(),a=0;e.pageNumber=void 0!=t?t:i,r[e.pageNumber-1].push(e),o.tab.saveData.call(o),r[e.pageNumber-1].forEach(function(e){"file"!=e.type&&"auto"!=e.from&&a++}),a-o.params.saveImgStep>=o.params.saveImgStep&&x.saveAsImage.call(o,r[e.pageNumber-1],o.container[n.id].type)},this.getData=function(){for(var e=0,t=[];e<c;)[].push.apply(t,r[e]),e++;return t},this.clear=function(e){var t=(e?e.pageNumber:i)||i;r[t-1].length=1,o.tab.saveData.call(o),(void 0===e||e.tabId==o.tab.getActive().id&&e.pageNumber==i)&&(o.mainCanvas.width=o.mainCanvas.width,void 0===e&&"[object Function]"===a.call(o.params.onClear)&&o.params.onClear({tabId:o.tab.getActive().id,pageNumber:t}))},this.render=function(e,t){var n=this;x.render.call(n,e,function(){if("[object Function]"===a.call(t)){var o=x.copy(e),r={},c=n.tab.getActive();r[c.id]={data:o,type:c.type,pageNumber:i,splitPage:c.page?1:0},t(r)}}),e.status&&n.tab.getActive().page.push.call(n,e)},o.params.disable&&this.disable(),o.tab.saveData.call(o),s&&this.show()}function t(o){if(!this instanceof t)return new t(o);var r=new Image;r.setAttribute("crossOrigin","anonymous");var l={pad:this,params:o,waitList:[],container:{},tplImage:r,id:o.id||c++,render:function(e){var t=l.tab.getActive();t.page?t.page.render.call(l,e,function(e){"[object Function]"===a.call(o.onRender)&&o.onRender(e)}):l.tab.render.call(l,e,function(e){"[object Function]"===a.call(o.onRender)&&o.onRender(e)})},mouseRender:function(e){if(T.render.call(l,e),o.onMousemove){var t=x.copy(e),n={},a=l.tab.getActive();n[a.id]={data:t,type:a.type},o.onMousemove(n)}}};(function(){var t=this,o=this.params,r=o.wrap,c=o.toolbars,l={},u=!1,d=null,f=null,h=null,y=new FileReader,j=!1,T="",R=!1,F=r.requestFullscreen||r.webkitRequestFullscreen||r.mozRequestFullScreen||r.msRequestFullscreen,I=document.exitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen,B=null,P=null,M=null,A=null,L=null,D=null,J=null,H=null;c.forEach(function(e){var t=m[e];switch(e){case"handPad":case"color":case"clear":case"export":break;default:t?t.forEach(function(t){l[t]=new n.module[e]({name:t})}):l[e]=new n.module[e]({name:e})}var a=S.replace(/@ITEM@/g,t?t[0]:e).replace(/@ICONCLASS@/g,t?b[t[0]]:b[e]).replace(/@TITLE@/g,t?g[t[0]]:g[e]).replace(/@LEVEL@/g,0);if(a=a.replace(/@CHILDTOOLBARS@/g,t?C:""),t){var i="";t.forEach(function(e){i+=S.replace(/@ITEM@/g,e).replace(/@ICONCLASS@/g,b[e]).replace(/@TITLE@/g,g[e]).replace(/@CHILDTOOLBARS@/g,"").replace(/@LEVEL@/g,1)}),a=a.replace(/@CHILDTOOLBARITEM@/g,i)}T+=a}),0!=o.fullScreen&&(T+=O);var W=w.replace(/@LAYOUT@/g,v[o.layout]+(o.vertical?" vertical":"")).replace(/@TOOLBARS@/g,T).replace(/@DISABLED@/g,o.disable?"disabled":"").replace(/@NOTOOLBAR@/g,o.noToolbar?"no-toolbar":"").replace(/@NOTAB@/g,o.noTab?"no-tab":""),V=o.data||(o.noCache?null:JSON.parse(window.localStorage.getItem(t.id+"_pad")));r.innerHTML=W,this.toolbarMap=l;var z=r.getElementsByClassName("can-wrap")[0],U=r.getElementsByClassName("toolbar-list")[0],G=U.getElementsByClassName("full-screen-btn")[0];B=r.getElementsByClassName("color-input")[0],P=r.getElementsByClassName("file-input")[0],M=r.getElementsByClassName("text-input")[0],A=r.getElementsByClassName("main-can")[0],L=r.getElementsByClassName("buffer-can-1")[0],D=r.getElementsByClassName("buffer-can-2")[0],J=r.getElementsByClassName("buffer-can-3")[0],H=r.getElementsByClassName("buffer-can-4")[0],N.redefineEvent("mousemove","mouserun",L);var $=function(){var e=z.clientWidth,t=z.clientHeight;switch(!0){case/^\s*(\d+)\s*\*\s*(\d+)\s*$/.test(o.size):e=+RegExp.$1,t=+RegExp.$2;break;case/^\s*(\d+)\s*:\s*(\d+)\s*$/.test(o.size):var n=z.clientWidth,a=z.clientHeight;switch(!0){case RegExp.$1/RegExp.$2>n/a:e=n,t=n/RegExp.$1*RegExp.$2;break;case RegExp.$1/RegExp.$2<n/a:t=a,e=a/RegExp.$2*RegExp.$1;break;default:e=n,t=a}break;case/^\s*(\d+)%\s*$/.test(o.size):var n=z.clientWidth,a=z.clientHeight;e=n/100*RegExp.$1,t=a/100*RegExp.$1;break;default:e=z.clientWidth,t=z.clientHeight}o.width=e>>0,o.height=t>>0};N.addEvent(z,p.wheel,function(){var e=[].slice.call(arguments,0),t=e[0]||window.event;if(window.event?(t.returnValue=!1,t.cancelBubble=!0):(t.preventDefault(),t.stopPropagation()),1!=X.disable&&X.scrollObj.y.coverHeight>0){var n={type:"y",from:o.id,coverHeight:X.scrollObj.y.coverHeight,distance:X.scrollObj.y.top+("DOMMouseScroll"===t.type?3===t.detail?100:-100:t.deltaY)/5};X.scroll(n)}});var _=z.clientWidth,q=z.clientHeight;N.redefineEvent("resize","sizeChange",window),N.addEvent(window,"sizeChange",function(){var e=z.clientWidth,n=z.clientHeight;e==_&&n==q||($(),t.tab.active.call(t,t.tab.getActive().id,null,!0),_=e,q=n),t.tab.resizeTab()});var Y=function(e,t){var n=e||o.width,a=t||o.height;if(A.style.width=L.style.width=D.style.width=J.style.width=H.style.width=n+"px",A.style.height=L.style.height=D.style.height=J.style.height=H.style.height=a+"px",A.style.left=L.style.left=D.style.left=J.style.left=H.style.left=0,A.style.top=L.style.top=D.style.top=J.style.top=H.style.top=0,n<z.clientWidth){var i=(z.clientWidth-n)/2;A.style.left=L.style.left=D.style.left=J.style.left=H.style.left=i+"px"}if(a<z.clientHeight){var r=(z.clientHeight-a)/2;A.style.top=L.style.top=D.style.top=J.style.top=H.style.top=r+"px"}X&&X.resize()},Z=function(e,t){var n=e||o.width,a=t||o.height;A.width=L.width=D.width=J.width=H.width=n,A.height=L.height=D.height=J.height=H.height=a};t.tab=new k(o.wrap),t.textInput=M,t.mouseIconCanvas=L,t.createImageCanvas=J,t.fileCanvas=H,t.mainCanvas=A,$();var X=E.init({node:z,id:o.id});X.disable=o.disable,t.scroll=X,X.addEvent("scroll",function(e){"[object Function]"===a.call(o.onScroll)&&o.onScroll(e)}),Object.defineProperty(t.tab,"resizePad",{value:Y}),Object.defineProperty(t.tab,"resizePadPixel",{value:Z}),N.addEvent(B,"change",function(){t.params.color=this.value}),N.addEvent(r.getElementsByClassName("pad-wrap")[0],p.fullScreen,function(){R=!R,N.removeClass(G,R?"icon-enlarge":"icon-narrow"),N.addClass(G,R?"icon-narrow":"icon-enlarge")});var Q=function(e){s?(e?N.addClass(r,"pad-full-screen"):N.removeClass(r,"pad-full-screen"),R=e,N.removeClass(G,R?"icon-enlarge":"icon-narrow"),N.addClass(G,R?"icon-narrow":"icon-enlarge"),t.tab.active.call(t,t.tab.getActive().id)):e?F.call(r.getElementsByClassName("pad-wrap")[0]):I.call(document)};t.pad.resize=function(e,n){isNaN(e)||isNaN(n)?($(),t.tab.active.call(t,t.tab.getActive().id)):(Y(e,n),Z(e,n),t.tab.active.call(t,t.tab.getActive().id,!0))},t.pad.scroll=function(e){X.scroll(e)},t.pad.fullScreen=function(){R||Q(!0)},t.pad.exitFullScreen=function(){R&&Q(!1)},t.pad.showFiles=function(n){var i=n.files,o=n.newTab,r=n.isShow,c=void 0!=n.from?n.from:t.params.id,l=n.tabId,s=n.tabName,u=t.tab.getActive();i="[object Array]"===a.call(i)?i:[i];var d=function(){var l=new e({data:i,show:r,that:t,width:n.width,height:n.height,from:c,tabId:o?f:u.id});t.tab.setPage.call(t,void 0!=f?f:u.id,l),u.page=l,t.params.id==c&&"[object Function]"===a.call(t.params.onShowFiles)&&(n.from=c,t.params.onShowFiles(n))};if(o){var f=t.tab.build.call(t,H,{type:1,id:l,name:s,from:c});n.tabId=f,r&&(t.tab.active.call(t,f),d(),c==t.params.id&&t.params.onTabChange&&t.params.onTabChange(f))}else 0==t.tab.getActive().id?(t.toolbarMap.image.renderBuffer.call(t,n.files),t.toolbarMap.image.render.call(t,[0,0])):(t.pad.clear(),d())},y.onload=function(e){t.toolbarMap.image.renderBuffer.call(t,e.target.result),t.toolbarMap.image.render.call(t,[0,0]),P.value=""},N.addEvent(P,"change",function(){y.readAsDataURL(this.files[0])}),N.addEvent(M,"input",function(){this.style.width=this.scrollWidth+"px"}),N.addEvent(M,"keyup",function(){if(13===([].slice.call(arguments,0)[0]||window.event).which){var e=x.trim(this.value);d.render.call(t,e)}}),N.addEvent(document,"keydown",function(){var e=[].slice.call(arguments,0),n=e[0]||window.event,a=n.which;if(t.active)switch(!0){case 107===a||187===a&&n.shiftKey:d&&d.largen&&d.largen.call(t);break;case 109===a||189===a&&n.shiftKey:d&&d.lesser&&d.lesser.call(t)}}),N.addEvent(U,p.click,function(){if(!o.disable){var e=[].slice.call(arguments,0),n=e[0]||window.event,a=n.srcElement||n.target,r=+a.getAttribute("level"),c=a.getAttribute("item");if(c){switch(d&&d.destory.call(t),c){case"handPad":(u=!u)?a.setAttribute("active",""):a.removeAttribute("active");break;case"color":B.click();break;case"clear":t.tab.clear.call(t);break;case"export":!function(){var e=t.tab.getActive().name||x.uuid,n=document.createElement("A"),a=t.createImageCanvas,o=a.getContext("2d"),r=t.params.wrap.getElementsByClassName("pad-wrap")[0];o.drawImage(t.fileCanvas,0,0),o.drawImage(t.mainCanvas,0,0);for(var c=a.toDataURL().split(","),l=atob(c[1]),s=l.length,u=new Uint8ClampedArray(s);s--;)u[s]=l.charCodeAt(s);var d=i.createObjectURL(new Blob([u],{mime:"image/octet-stream;Content-Disposition:attachment"}));n.className="export-image",n.href=d,n.download=e+".png",r.appendChild(n),n.click();var f=setTimeout(function(){f&&clearTimeout(f),i.revokeObjectURL(d)},300);a.width=a.width,r.removeChild(n)}();break;case"image":P.click();break;case"fullScreen":Q(!R);break;default:if(!(d=l[c]||d))return;if(t.current=d,d.active(),0===r){f&&f.removeAttribute("active"),f=a;var s=U.getElementsByClassName("selected-item")[0];a.parentNode!=s&&N.removeClass(s,"selected-item"),N.addClass(a.parentNode,"selected-item")}if(1===r){h&&h.removeAttribute("active");var p=N.preNode(a.parentNode.parentNode);p.title=a.parentNode.title,p.className=p.className.replace(/\bicon-[\w-]+\b/,a.className.match(/\bicon-[\w-]+\b/)),p.setAttribute("item",c),h=a}a.setAttribute("active","")}c&&(window.event?(n.returnValue=!1,n.cancelBubble=!0):(n.preventDefault(),n.stopPropagation()))}}}),N.addEvent(U,"mousedown",function(){var e=[].slice.call(arguments,0),t=e[0]||window.event;window.event?(t.returnValue=!1,t.cancelBubble=!0):(t.preventDefault(),t.stopPropagation())});var K=0,ee=0;if(N.addEvent(L,p.move,function(){var e=[].slice.call(arguments,0)[0]||window.event;if(e=s?e:e.detail?e.detail:e,!(s&&e.targetTouches.length>1)){var n=this.getBoundingClientRect(),a=s?e.targetTouches[0].clientX:e.clientX,i=s?e.targetTouches[0].clientY:e.clientY,r={x:a-(n.x||n.left),y:i-(n.y||n.top)};if(d){var c=d.name.toLowerCase();if(u||j)switch(c){case"ferula":d.mouseRender.call(t,r);break;case"circular":case"quadrate":d.mouseRender.call(t,r);default:d.bufferRender.call(t,r)}else d.mouseRender&&d.mouseRender.call(t,r)}else if(j){if(!0===X.disable)return;var l=K-a,f=ee-i;s&&(l/=10,f/=10),X.scrollObj.x.coverWidth>0&&(X.scroll({type:"x",from:o.id,distance:X.scrollObj.x.left+l,coverWidth:X.scrollObj.x.coverWidth}),K=a),X.scrollObj.y.coverHeight>0&&(X.scroll({type:"y",from:o.id,distance:X.scrollObj.y.top+f,coverHeight:X.scrollObj.y.coverHeight}),ee=i)}}}),N.addEvent(L,p.down,function(){var e=[].slice.call(arguments,0)[0]||window.event,n=this.getBoundingClientRect(),a=U.getElementsByClassName("selected-item")[0],i={x:(s?e.targetTouches[0].clientX:e.clientX)-(n.x||n.left),y:(s?e.targetTouches[0].clientY:e.clientY)-(n.y||n.top)};window.event?(e.returnValue=!1,e.cancelBubble=!0):(e.preventDefault(),e.stopPropagation()),K=s?e.targetTouches[0].clientX:e.clientX,ee=s?e.targetTouches[0].clientY:e.clientY,j=!0,d&&(N.removeClass(a,"selected-item"),d.bufferRender&&d.bufferRender.call(t,i,!0))}),N.addEvent(document,p.down,function(){var e=U.getElementsByClassName("selected-item")[0];N.removeClass(e,"selected-item"),d&&d.destory.call(t)}),N.addEvent(document,"mouseup",function(){j&&(j=!1,d&&d.render&&d.render.call(t))}),N.addEvent(L,p.up,function(){[].slice.call(arguments,0)[0]||window.event,j=!1,d&&d.render&&d.render.call(t)}),N.addEvent(z,"mouseleave",function(){d&&d.destory.call(t)}),t.bufferCanvas=D,V)Object.keys(V).sort(function(e,t){return e-t}).forEach(function(n){var a=V[n],i=t.tab.build.call(t,0===a.type?A:H,{type:a.type,data:a.data,id:n,name:a.tabName,from:a.from});if(a.splitPage){var o=new e({data:a.data,show:0===a.type,that:t,tabId:i});t.tab.setPage.call(t,i,o)}0===a.type&&t.tab.active.call(t,i)});else{var te=t.tab.build.call(t,A,{type:0});t.tab.active.call(t,te)}}).call(l);var u=function(e){var t=l.tab.getActive();for(var n in e)if(e.hasOwnProperty(n)){var a=e[n],i=(a.type,a.data);if(n==t.id)t.page?t.page.getPageNumber()==a.pageNumber?t.page.render.call(l,i):i.status&&t.page.push.call(l,i,+a.pageNumber):l.tab.render.call(l,i);else if(l.tab.getTab(n)){if(i.status){var o=l.tab.getPage(n);o?o.push.call(l,i,+a.pageNumber):l.tab.push.call(l,n,i)}}else l.tab.build.call(l,l.fileCanvas,{type:1,data:[i],id:n,from:i.from})}};this.render=function(e){"[object Object]"==a.call(e)&&u(e)},this.renderAll=function(e){"[object Object]"==a.call(e)&&e.forEach(function(e){u(e)})},this.mouseCtrl=function(e){"[object Object]"==a.call(e)&&function(e){for(var t in e)if(e.hasOwnProperty(t)){(n=e[t]).type;var n=n.data;T.render.call(l,n)}}(e)},this.clear=function(e){l.tab.clear.call(l,e)},this.disable=function(){N.addClass(o.wrap.firstElementChild||o.wrap.firstChild,"disabled"),o.disable=!0},this.enable=function(){N.removeClass(o.wrap.firstElementChild||o.wrap.firstChild,"disabled"),o.disable=!1},this.createImage=function(){return l.mainCanvas.toDataURL()},this.getData=function(e){return l.container[e]||l.container},this.changeTab=function(e){return l.tab.active.call(l,e)},this.turnPage=function(e,t){e==l.tab.getActive().id&&l.tab.getPage.call(l,e).go(t)},this.removeTab=function(e){void 0!=e&&l.tab.remove.call(l,e)},N.addEvent(o.wrap,"mouseenter",function(){l.active=!0}),N.addEvent(o.wrap,"mouseleave",function(){l.active=!1})}var n=window.vm||{},a=Object.prototype.toString,i=window.URL||window.webkitURL,o=window.CustomEvent,r={},c=0,l=[],s=/(\bmobile\b|\bandroid\b)/i.test(navigator.userAgent),u=/\bfirefox\b/i.test(navigator.userAgent),d=/\bMSIE\b/i.test(navigator.userAgent),f=/\bchrome\b/i.test(navigator.userAgent),p={click:s?"touchend":"click",down:s?"touchstart":"mousedown",move:s?"touchmove":"mouserun",up:s?"touchend":"mouseup",wheel:u?"DOMMouseScroll":"mousewheel",fullScreen:d?"MSFullscreenChange":f?"webkitfullscreenchange":u?"mozfullscreenchange":"fullscreenchange"},v={leftTop:"left-top",rightTop:"right-top",rightBottom:"right-bottom",leftBottom:"left-bottom"},h={data:null,noCache:!1,noTab:!1,super:!1,noToolbar:!1,layout:"leftTop",size:"100%",fontSize:16,vertical:!1,disable:!1,wrap:document.body,autoSaveTime:10,saveImgStep:5,color:"#000",background:"#fff",eraserSize:5,ferulaSize:5,tabLimit:20,toolbars:s?["pen","line","rectangle","round","text","image","eraser","export","clear"]:["ferula","pen","line","rectangle","round","text","image","eraser","export","clear","color"]},m={rectangle:["rectstroke","rect"],line:["line","arrow"],round:["circle","roundel","ellipesstroke","ellipes"],eraser:["circular","quadrate"]},g={ferula:"教鞭",circle:"空心圆",roundel:"实心圆",ellipesstroke:"空心椭圆",rectstroke:"空心矩形",pen:"画笔",circular:"圆形橡皮擦",quadrate:"方形橡皮擦",rect:"实心矩形",ellipes:"实心椭圆",text:"文本",line:"直线",arrow:"箭头",color:"颜色",export:"导出",scissors:"截图",clear:"清空",image:"图片"},b={ferula:"icon-teach-rod",circle:"icon-round-a",roundel:"icon-round-c",ellipesstroke:"icon-ellipse-b",rectstroke:"icon-rectangle-a",pen:"icon-pen",circular:"icon-xiangpica",quadrate:"icon-rubber",rect:"icon-rectangle-c",ellipes:"icon-ellipse-a",text:"icon-font",line:"icon-line",arrow:"icon-arrow",color:"icon-colour",export:"icon-keep",scissors:"icon-screenshot",clear:"icon-empty",image:"icon-pic"},y={0:"白板",1:"文档演示"},w='\t\t<div class="pad-wrap @LAYOUT@ @DISABLED@ @NOTOOLBAR@ @NOTAB@">\t\t\t<div class="toolbar-wrap">\t\t\t\t<ul class="toolbar-list">@TOOLBARS@</ul>\t\t\t</div>\t\t\t<div class="can-wrap-outer">\t\t\t\t<div class="can-wrap">\t\t\t\t\t<input type="text" class="text-input tool-input"/>\t\t\t\t\t<canvas class="main-can">抱歉！您的浏览器版本太低，暂时不支持此白板！</canvas>\t\t\t\t\t<canvas class="buffer-can-4"></canvas>\t\t\t\t\t<canvas class="buffer-can-3"></canvas>\t\t\t\t\t<canvas class="buffer-can-2"></canvas>\t\t\t\t\t<canvas class="buffer-can-1"></canvas>\t\t\t\t</div>\t\t\t\t<div class="split-page-wrap"></div>\t\t\t</div>\t\t\t<div class="pad-tab-wrap">\t\t\t\t<ul class="pad-tab-list"></ul>\t\t\t</div>\t\t\t<input type="file" accept="image/png, image/jpeg" class="file-input tool-input"/>\t\t\t<input type="color" class="color-input tool-input"/>\t\t</div>',S='<li class="toolbar-item" title="@TITLE@"><span class="item-icon iconfont @ICONCLASS@" item="@ITEM@" level="@LEVEL@"></span>@CHILDTOOLBARS@</li>',C='<ul class="child-toolbar-list">@CHILDTOOLBARITEM@</ul>',j='\t\t<div class="split-page">\t\t\t<a href="javascript:void(0);" class="pre-page-btn iconfont icon-zuofanye"></a>\t\t\t<a href="javascript:void(0);" class="next-page-btn iconfont icon-youfanye"></a>\t\t\t<span><input type="text" class="page-number-input"/>/@TOTAL@<a href="javascript:void(0);" class="go-page-btn">GO</a></span>\t\t</div>',O='<li class="toolbar-item full-screen-btn-wrap"><span class="item-icon full-screen-btn iconfont icon-enlarge" item="fullScreen"></span></li>';n.module=n.module||{};var N={addEvent:window.addEventListener?function(e,t,n,a){e.addEventListener(t,n,a||!1)}:function(e,t,n){e.attachEvent("on"+t,n)},delEvent:window.addEventListener?function(e,t,n,a){e.removeEventListener(t,n,a||!1)}:function(e,t,n){e.detachEvent("on"+t,n)},redefineEvent:function(e,t,n,a){var i=n||window,r=!1,c=function(){if(!r){var e=[].slice.call(arguments,0)[0]||window.event;r=!0,window.requestAnimationFrame(function(){i.dispatchEvent(new o(t,{detail:e})),r=!1})}};return this.addEvent(i,e,c,a),c},addClass:function(e,t){void 0!==e&&void 0!==t&&(new RegExp("\\b"+t+"\\b","g").test(e.className)||(e.className=e.className+" "+t))},removeClass:function(e,t){if(void 0!==e&&void 0!==t){var n=new RegExp("\\b"+t+"\\b","g");n.test(e.className)&&(e.className=e.className.replace(n,""))}},preNode:function(e){return e.previousElementSibling||e.previousSibling},nextNode:function(e){return e.nextElementSibling||e.nextSibling},css:function(e,t,n){e.style[t]=n||""}},E=function(){function e(t){if(!(this instanceof e))return new e(t);var a=this,r=!1,c="x",l={x:0,y:0},u=null,d=t.node.parentNode;a.params=t,a.events={},a.scrollObj={};var f=function(e){n.innerHTML="x"===e?i:o;var r=n.removeChild(n.firstChild);d.appendChild(r),a.scrollObj[e]={container:r,toolbar:r.getElementsByClassName("scroll-toolbar")[0]},"x"===e?(t.node.clientWidth<t.node.scrollWidth&&r.classList.remove("pad-hide"),a.scrollObj[e].left=0):(t.node.clientHeight<t.node.scrollHeight&&r.classList.remove("pad-hide"),a.scrollObj[e].top=0)};Object.defineProperty(this,"disable",{set:function(e){r=e},get:function(){return r}}),t.type?f(t.type):(f("x"),f("y"));var p=function(){var e=[].slice.call(arguments,0),n=a.scrollObj[c],i=e[0]||window.event;if(i=s?i:i.detail?i.detail:i,"x"===c){var o=i.x||i.clientX,r={type:"x",from:t.id,coverWidth:n.coverWidth,distance:n.left+(o-l.x)};l.x=o}else{var u=i.y||i.clientY;r={type:"y",from:t.id,coverHeight:n.coverHeight,distance:n.top+(u-l.y)},l.y=u}a.scroll(r)},v=function e(){N.delEvent(document,"mousemove",u),N.delEvent(document,"mouseup",e)};a.scrollObj.x&&N.addEvent(a.scrollObj.x.toolbar,"mousedown",function(){if(!r){var e=[].slice.call(arguments,0)[0]||window.event;u=N.redefineEvent("mousemove","mouserun",document),l.x=e.x||e.clientX,c="x",N.addEvent(document,"mouserun",p),N.addEvent(document,"mouseup",v)}}),a.scrollObj.y&&N.addEvent(a.scrollObj.y.toolbar,"mousedown",function(){if(!r){var e=[].slice.call(arguments,0)[0]||window.event;u=N.redefineEvent("mousemove","mouserun",document),l.y=e.y||e.clientY,c="y",N.addEvent(document,"mouserun",p),N.addEvent(document,"mouseup",v)}})}var t=[],n=document.createElement("DIV"),i='<div class="scroll-x-wrap pad-hide"><span class="scroll-x scroll-toolbar"></span></div>',o='<div class="scroll-y-wrap pad-hide"><span class="scroll-y scroll-toolbar"></span></div>';return e.prototype={constructor:e,scroll:function(e){var t=this.params,n=this.scrollObj[e.type],a=(n.container,n.toolbar);if("x"===e.type){e.distance=e.distance*(n.coverWidth/e.coverWidth);var i=Math.max(0,Math.min(n.coverWidth,e.distance));t.node.scrollLeft=i,a.style.left=n.moveWidth*(i/n.coverWidth)+"px",this.scrollObj.x.left=i}else{e.distance=e.distance*(n.coverHeight/e.coverHeight);var o=Math.max(0,Math.min(n.coverHeight,e.distance));t.node.scrollTop=o,a.style.top=n.moveHeight*(o/n.coverHeight)+"px",this.scrollObj.y.top=o}void 0!=this.params.id&&e.from!=this.params.id||this.fire("scroll",e)},toOrigin:function(e){var t=this.params;e?"x"===e?(this.scrollObj.x.toolbar.style.left=0,t.node.scrollLeft=0):(this.scrollObj.y.toolbar.style.top=0,t.node.scrollTop=0):(this.scrollObj.x.toolbar.style.left=0,this.scrollObj.y.toolbar.style.top=0,t.node.scrollLeft=0,t.node.scrollTop=0)},resize:function(){var e=this.params;if(this.scrollObj.x){var t=(a=this.scrollObj.x).toolbar,n=e.node.scrollWidth-e.node.clientWidth;t.style.width=Math.max(a.container.clientWidth-n/10,50)+"px",a.coverWidth=n,a.moveWidth=a.container.clientWidth-t.offsetWidth,0===a.moveWidth?a.container.classList.add("pad-hide"):a.container.classList.remove("pad-hide")}if(this.scrollObj.y){t=(a=this.scrollObj.y).toolbar;var a,i=e.node.scrollHeight-e.node.clientHeight;t.style.height=Math.max(a.container.clientHeight-i/10,50)+"px",a.coverHeight=i,a.moveHeight=a.container.clientHeight-t.offsetHeight,0===a.moveHeight?a.container.classList.add("pad-hide"):a.container.classList.remove("pad-hide")}},addEvent:function(e,t){var n=this.events;n[e]?n[e].push(t):n[e]=[t]},delEvent:function(e,t){var n=this.events;"[object Function]"===a.call(t)?n[e].splice(n[e].indexOf(t),1):delete n[e]},fire:function(){var e=[].slice.call(arguments,0),t=e.shift(),n=this.events;n[t]&&n[t].forEach(function(t){"[object Function]"===a.call(t)&&t.apply(Object.create(null),e)})}},{init:function(n){if(n.node){var a=new e(n);return t.push(a),a}},resize:function(){t.forEach(function(e){e.resize()})}}}(),x={get uuid(){return Date.now().toString()},scale:function(e){var t=e,n=t.type,a=null,i=null;switch(a&&i||(a=this.mainCanvas.width/t.width,i=this.mainCanvas.height/t.height),n){case"pen":t.data.x=t.data.x*a,t.data.y=t.data.y*i;break;case"text":t.data[0]=t.data[0]*a,t.data[1]=t.data[1]*a;break;case"image":case"file":break;case"eraser":t.data.x=t.data.x*a,t.data.y=t.data.y*i,t.data.size=t.data.size*a;break;default:t.data[0]&&(t.data[0]=isNaN(t.data[0])?t.data[0]:t.data[0]*a),t.data[1]&&(t.data[1]=isNaN(t.data[1])?t.data[1]:t.data[1]*a),t.data[2]&&(t.data[2]=isNaN(t.data[2])?t.data[2]:t.data[2]*a),t.data[3]&&(t.data[3]=isNaN(t.data[3])?t.data[3]:t.data[3]*a)}},copy:function(){var e=[].slice.call(arguments,0),t=e.shift();if(e.length)return"[object Object]"!=(r=a.call(t))&&"[object Array]"!=r?t:(e.forEach(function(e){var n=a.call(e);if("[object Object]"==n||"[object Array]"==n)if("[object Object]"===n){if("[object Array]"===c)var i={};for(var o in e)if(e.hasOwnProperty(o)){var r=e[o],c=a.call(r);i?i[o]="[object Object]"===c||"[object Array]"===c?x.copy(r):r:t[o]="[object Object]"===c||"[object Array]"===c?x.copy(r):r}i&&t.push(i)}else e.forEach(function(e,n){var i=a.call(e);"[object Object]"===c?t[n]="[object Object]"===i||"[object Array]"===i?x.copy(r):r:"[object Object]"===i||"[object Array]"===i?t.push(x.copy(r)):t.push(r)})}),t);if("[object Object]"!=(r=a.call(t))&&"[object Array]"!=r)return t;if("[object Object]"===r){var n={};for(var i in t)if(t.hasOwnProperty(i)){var o=t[i],r=a.call(o);n[i]="[object Object]"===r||"[object Array]"===r?x.copy(o):o}}else n=[],t.forEach(function(e){var t=a.call(e);"[object Object]"===t||"[object Array]"===t?n.push(x.copy(e)):n.push(e)});return n},saveAsImage:function(e,t){for(var n=this,a=0,i=[],o=null,r=e.length,c=n.tab.getActive(),l=n.createImageCanvas;r--;){var s=e.pop();if(i.unshift(s),s.origin&&a++,n.params.saveImgStep<=a){l.width=l.width,e.length?function t(a){var r=a.shift();if(!r)return function(){var t=l.toDataURL(),a=n.tab.getPage(c.id);l.width=l.width;var r={type:"image",data:[t,0,0],width:0,height:0,status:1,origin:!0,from:"auto"};a&&(r.pageNumber=a.getPageNumber()),o&&e.push(o),e.push(r),[].push.apply(e,i),n.tab.saveData.call(n)}();"file"===r.type?(o=r,t(a)):x.render.call(n,r,function(){t(a)},!0)}(e):[].push.apply(e,i);break}}},trim:function(e){if(e&&"[object String]"==a.call(e))return e.replace(/^\s*|\s*$/,"")},splitPage:function(e){var t={},n=[],i=[];for(var o in e.forEach(function(e){"[object String]"===a.call(e)?i.push(e):(t[e.pageNumber]=t[e.pageNumber]||[],t[e.pageNumber].push(e))}),t)t.hasOwnProperty(o)&&n.push(o);return n.sort(function(e,t){return e-t}),n.forEach(function(e){i.push(t[e])}),i},renderPen:function(e,t,n){var a=this,i=n?a.createImageCanvas:0===e.status?a.bufferCanvas:a.mainCanvas,o=e.data,r=i.width/e.width,c=i.height/e.height,l=i.getContext("2d");0===e.status?i.width=i.width:a.bufferCanvas.width=a.bufferCanvas.width,l.strokeStyle=e.color,l.lineWidth=1,l.save(),l.scale(r,c),o.forEach(function(e,t){0===t?(l.beginPath(),l.moveTo(e.x,e.y)):l.lineTo(e.x,e.y)}),l.stroke(),l.restore(),t&&t()},renderRect:function(e,t,n){var a=this,i=(e.mode,n?a.createImageCanvas:0===e.status?a.bufferCanvas:a.mainCanvas),o=e.data,r=i.width/e.width,c=i.height/e.height,l=i.getContext("2d");0===e.status?i.width=i.width:a.bufferCanvas.width=a.bufferCanvas.width,l.save(),l.scale(r,c),l.beginPath(),0===e.mode?(l.strokeStyle=e.color,l.lineWidth=1,l.strokeRect(o[0],o[1],o[2],o[3])):(l.fillStyle=e.color,l.fillRect(o[0],o[1],o[2],o[3])),l.restore(),t&&t()},renderLine:function(e,t,n){var a=this,i=e.mode,o=n?a.createImageCanvas:0===e.status?a.bufferCanvas:a.mainCanvas,r=e.data,c=o.width/e.width,l=o.height/e.height,s=o.getContext("2d");if(0===e.status?o.width=o.width:a.bufferCanvas.width=a.bufferCanvas.width,s.strokeStyle=e.color,s.lineWidth=1,s.save(),s.scale(c,l),s.beginPath(),s.moveTo(r[0],r[1]),s.lineTo(r[2],r[3]),1===i){var u=180*Math.atan2(r[1]-r[3],r[0]-r[2])/Math.PI,d=(u+30)*Math.PI/180,f=(u-30)*Math.PI/180,p=15*Math.cos(d),v=15*Math.sin(d),h=15*Math.cos(f),m=15*Math.sin(f);s.moveTo(p+r[2],v+r[3]),s.lineTo(r[2],r[3]),s.moveTo(h+r[2],m+r[3]),s.lineTo(r[2],r[3])}s.stroke(),s.restore(),t&&t()},renderRound:function(e,t,n){var a=this,i=e.mode,o=n?a.createImageCanvas:0===e.status?a.bufferCanvas:a.mainCanvas,r=e.data,c=o.width/e.width,l=o.height/e.height,s=o.getContext("2d");switch(0===e.status?o.width=o.width:a.bufferCanvas.width=a.bufferCanvas.width,s.save(),s.scale(c,l),s.beginPath(),i){case 0:s.strokeStyle=e.color,s.lineWidth=1,s.arc(r[0],r[1],r[2],0,2*Math.PI),s.stroke();break;case 1:s.fillStyle=e.color,s.arc(r[0],r[1],r[2],0,2*Math.PI),s.fill();break;case 2:s.strokeStyle=e.color,s.lineWidth=1;var u=r[2]>r[3]?r[2]:r[3],d=r[2]/u,f=r[3]/u;s.scale(d,f),s.arc(r[0]/d,r[1]/f,u,0,2*Math.PI),s.closePath(),s.stroke();break;case 3:s.fillStyle=e.color,u=r[2]>r[3]?r[2]:r[3],d=r[2]/u,f=r[3]/u,s.scale(d,f),s.arc(r[0]/d,r[1]/f,u,0,2*Math.PI),s.closePath(),s.fill()}s.restore(),t&&t()},renderText:function(e,t,n){var a=this,i=n?a.createImageCanvas:0===e.status?a.bufferCanvas:a.mainCanvas,o=e.data,r=i.width/e.width,c=i.height/e.height,l=i.getContext("2d");0===e.status?i.width=i.width:a.bufferCanvas.width=a.bufferCanvas.width,l.fillStyle=e.color,l.font=e.size+"px sans-serif",l.save(),l.scale(r,c),l.beginPath(),l.fillText(o[2],o[0],o[1]),l.restore(),t&&t()},renderImage:function(e,t,n){var a=this,i=n?a.createImageCanvas:0===e.status?a.bufferCanvas:"file"===e.type?a.fileCanvas:a.mainCanvas,o=e.data,r=e.width,c=e.height,l=a.tplImage,s=i.getContext("2d");l.src=o[0],l.onload=function(){var o=l.width,u=l.height;if("file"!==e.type||0==e.status||n||(r=a.params.width,c=a.params.height,a.tab.resizePad(r,c),a.tab.resizePadPixel(r,c)),s.save(),"file"===e.type){var d=o,f=u;c>r/(o/u)?f=u+u*(c/r-u/o)>>0:c=r/(o/u)>>0,a.tab.resizePad(r,c),a.tab.resizePadPixel(d,f),s.drawImage(l,(d-o)/2,(f-u)/2,o,u)}else{var p=i.width,v=i.height,h=o*(p/r),m=u*(v/c),g=p-h,b=v-m;if(g>=0&&b>=0){var y=g/2,w=b/2;s.drawImage(l,y,w,h,m)}else{var S=p/v,C=l.width/l.height;S>C?s.drawImage(l,(p-v*C)/2,0,v*C,v):s.drawImage(l,0,(v-p/C)/2,p,p/C)}}s.restore(),t&&t()}},delete:function(e,t,n){var a=this,i=n?a.createImageCanvas:0===e.status?a.bufferCanvas:a.mainCanvas,o=e.data,r=i.width/e.width,c=i.height/e.height,l=i.getContext("2d");0===e.status?i.width=i.width:a.bufferCanvas.width=a.bufferCanvas.width,o.forEach(function(t){if(0===e.mode){var n=t.size/2*Math.sin(Math.atan((t.y-t.ey)/(t.x-t.ex)))||0,o=t.size/2*Math.cos(Math.atan((t.y-t.ey)/(t.x-t.ex)))||0,s=t.ex+n,u=t.ey-o,d=t.ex-n,f=t.ey+o,p=t.x+n,v=t.y-o,h=t.x-n,m=t.y+o;l.save(),l.scale(r,c),l.beginPath(),l.arc(t.x,t.y,t.size/2,0,2*Math.PI),l.clip(),l.clearRect(0,0,i.width,i.height),l.restore()}else s=t.ex-t.size/2,u=t.ey-t.size/2,d=t.ex-t.size/2,f=t.ey+t.size/2,p=t.x+t.size/2,v=t.y-t.size/2,h=t.x-t.size/2,m=t.y+t.size/2,l.save(),l.scale(r,c),l.beginPath(),l.rect(s,u,t.size,t.size),l.clip(),l.clearRect(0,0,i.width,i.height),l.restore();l.save(),l.scale(r,c),l.beginPath(),l.moveTo(s,u),l.lineTo(d,f),l.lineTo(p,v),l.lineTo(h,m),l.closePath(),l.clip(),l.clearRect(0,0,a.params.width,a.params.height),l.restore()}),t&&t()},render:function(e,t,n){var a=this;switch(e.type){case"pen":x.renderPen.call(a,e,t,n);break;case"rectangle":x.renderRect.call(a,e,t,n);break;case"line":x.renderLine.call(a,e,t,n);break;case"round":x.renderRound.call(a,e,t,n);break;case"text":x.renderText.call(a,e,t,n);break;case"image":case"file":x.renderImage.call(a,e,t,n);break;case"eraser":x.delete.call(a,e,t,n)}}},T={eraser:function(e){var t=this.mouseIconCanvas,n=e.data,a=e.mode,i=t.width/e.width,o=t.height/e.height,r=t.getContext("2d");if(t.width=t.width,-1!==n[0]&&-1!==n[1])if(r.scale(i,o),r.beginPath(),0===a)r.arc(n[0],n[1],n[2]/2,0,2*Math.PI),r.stroke();else{var c=n[0]-n[2]/2,l=n[1]-n[2]/2;r.rect(c,l,n[2],n[2]),r.stroke()}},ferula:function(e){var t=this.mouseIconCanvas,n=e.data,a=this.params.ferulaSize,i=t.width/e.width,o=t.height/e.height,r=t.getContext("2d");t.width=t.width,-1!==n[0]&&-1!==n[1]&&(r.scale(i,o),r.beginPath(),r.fillStyle="red",r.arc(n[0],n[1],a,0,2*Math.PI),r.fill())},render:function(e){var t=e.type;T[t]&&T[t].call(this,e)}},k=function(){function e(e){var o=this,r={},c={},l={},s={},u=[],d=!1,f={},v=e.getElementsByClassName("pad-tab-list")[0];o.build=function(e,d){if(e){if(!(u.length>=this.params.tabLimit)){var f=this,h=d.type,m=d.data,g=d.from,b=0!==d.type&&(!!f.params.super||g==f.params.id),w=d.id?d.id:0===h?0:x.uuid,S=n.replace(/@LABEL@/g,d.name?d.name:y[h]).replace(/@DELETEBTN@/g,b?i:"");t.innerHTML=S,u.push(w);var C=t.firstElementChild||t.firstChild;return r[w]=C,c[w]=m||[],l[w]=e,b&&N.addEvent(C.getElementsByTagName("i")[0],p.click,function(){var e=[].slice.call(arguments,0)[0]||window.event;window.event?(e.returnValue=!1,e.cancelBubble=!0):(e.preventDefault(),e.stopPropagation()),o.remove.call(f,w),f.params.onTabRemove&&f.params.onTabRemove(w)}),N.addEvent(C,p.click,function(){!0!==f.params.disable&&this!==s.tab&&(o.active.call(f,w),f.params.onTabChange&&f.params.onTabChange(w))}),v.appendChild(C),f.container[w]={data:c[w],type:h,splitPage:0,from:g},o.resizeTab(),d.name&&(f.container[w].tabName=d.name),w}"[object Function]"===a.call(this.params.onError)&&this.params.onError({code:0,message:"白板页签已达上限"})}},o.push=function(e,t){var n=this,a=0;c[e]||(c[e]=[]),c[e].push(t),n.tab.saveData.call(n),c[e].forEach(function(e){"auto"!=e.from&&a++}),a-n.params.saveImgStep>=n.params.saveImgStep&&x.saveAsImage.call(n,c[e],n.container[e].type)},o.saveData=function(){var e=this;if(!d&&"never"!==e.params.autoSaveTime){e.params.autoSaveTime=isNaN(e.params.autoSaveTime)?10:+e.params.autoSaveTime;var t=setTimeout(function(){for(var n in f)if(f.hasOwnProperty(n)){var a=f[n];c[n].length=0,[].push.apply(c[n],a.getData())}!e.params.noCache&&window.localStorage.setItem(e.id+"_pad",JSON.stringify(e.container)),clearTimeout(t),d=!1},1e3*e.params.autoSaveTime);d=!0}},o.resizeTab=function(){var e=v.clientWidth/u.length;e=e>112?112:e,v.style.setProperty("--tab-width",e-12+"px")},o.remove=function(e){var t=this,n=r[e],a=u.indexOf(e);delete r[e],delete c[e],delete l[e],delete t.container[e],delete f[e],v.removeChild(n),u.splice(a,1),s.id==e&&(e=u[Math.max(a-1,0)],t.tab.active.call(t,e)),t.tab.resizeTab(),!t.params.noCache&&window.localStorage.setItem(t.id+"_pad",JSON.stringify(t.container))},o.active=function(e,t,n){if(!r[e])return!1;var a=this,i=c[e];if(N.removeClass(s.tab,"active"),t||(a.tab.resizePad(),a.tab.resizePadPixel()),!n&&a.scroll.toOrigin(),s.page&&(s.page.hide(),delete s.page),a.container[e].type!=s.type&&(N.css(s.canvas||a.mainCanvas,"background"),N.css(l[e],"background",a.params.background)),s.tab=r[e],s.data=c[e],s.canvas=l[e],s.id=e,s.type=a.container[e].type,s.name=a.container[e].tabName||"",s.page=f[e],N.addClass(s.tab,"active"),s.page&&s.page.show(),i&&!s.page){s.canvas.width=s.canvas.width;var o=0,u=i.length;if(u){!function e(){var t=i[o];t&&x.render.call(a,t,function(){++o<u&&e()})}()}}return!0},o.getActive=function(){return s},o.getTab=function(e){return r[e]},o.clear=function(e){var t=this;if(void 0===e)s.page?s.page.clear.call(t):(s.data.length=0,s.canvas.width=s.canvas.width,"[object Function]"===a.call(t.params.onClear)&&t.params.onClear({tabId:s.id}));else{var n=e.tabId;f[n]?f[n].clear.call(t,e):(c[n]&&(c[n].length=0),l[n]&&(l[n].width=l[n].width))}!t.params.noCache&&window.localStorage.setItem(t.id+"_pad",JSON.stringify(t.container))},o.cleanCache=function(){!this.params.noCache&&window.localStorage.removeItem(this.id+"_pad")},o.setPage=function(e,t){f[e]=t,this.container[e].splitPage=1},o.getPage=function(e){return f[e]},o.render=function(e,t){x.render.call(this,e,function(){if("[object Function]"===a.call(t)){var n=x.copy(e),i={};i[s.id]={data:n,type:s.type,splitPage:s.page?1:0},t(i)}}),e.status&&this.tab.push.call(this,s.id,e)}}var t=document.createElement("UL"),n='<li class="pad-tab-item" title="@LABEL@">@LABEL@@DELETEBTN@</li>',i='<i class="iconfont icon-close"></i>';return e.prototype={constructor:e},e}();e.prototype={constructor:e},window.wPad={init:function(e){var n=x.copy({},h);(n=x.copy(n,e)).id=void 0==n.id?x.uuid:n.id;var a=new t(n);return void 0!=n.id&&(r[n.id]=a),l.push(a),a},getPadById:function(e){if(void 0!==e)return r[e]},getPadByIndex:function(e){if(void 0!==e)return l[e]}}}()},{}],5:[function(e,t,n){!function(){function e(e){this.name=e.name||"Line",this.interimBuffer=[],this.points=[],this.buffer=[]}var t={line:0,arrow:1};e.prototype={constructor:e,active:function(){},bufferRender:function(e,n){var a=this;n?(a.current.points=[],a.current.points.push(e.x),a.current.points.push(e.y)):(a.current.points[2]=e.x,a.current.points[3]=e.y),n||(a.current.interimBuffer.pop(),e={type:"line",data:e=[].concat.apply([],a.current.points),status:0,mode:t[a.current.name],origin:!0,color:a.params.color,from:a.params.id,width:a.mainCanvas.offsetWidth,height:a.mainCanvas.offsetHeight},a.current.interimBuffer.push(e),a.render(e))},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)},destory:function(){}};var n=window.vm||{};n.module=n.module||{},n.module.line=e,window.vm=n}()},{}],6:[function(e,t,n){!function(){function e(e){this.name=e.name||"Pen",this.interimBuffer=[],this.buffer=[]}e.prototype={constructor:e,active:function(){},bufferRender:function(e,t){var n=this,a=t?{type:"pen",data:[],status:0,origin:!!t,color:n.params.color,from:n.params.id,width:n.mainCanvas.offsetWidth,height:n.mainCanvas.offsetHeight}:n.current.interimBuffer.pop();a.data.push(e),n.current.interimBuffer.push(a),n.render(a)},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)},destory:function(){}};var t=window.vm||{};t.module=t.module||{},t.module.pen=e,window.vm=t}()},{}],7:[function(e,t,n){!function(){function e(e){this.name=e.name||"Rectangle",this.interimBuffer=[],this.points=[],this.buffer=[]}var t={rectstroke:0,rect:1};e.prototype={constructor:e,active:function(){},bufferRender:function(e,n){var a=this;n?(a.current.points=[],a.current.points.push(e.x),a.current.points.push(e.y)):(a.current.points[2]=e.x-(a.current.points[0]||0),a.current.points[3]=e.y-(a.current.points[1]||0),a.current.interimBuffer.pop(),e={type:"rectangle",data:e=[].concat.apply([],a.current.points),status:0,mode:t[a.current.name],origin:!0,color:a.params.color,from:a.params.id,width:a.mainCanvas.offsetWidth,height:a.mainCanvas.offsetHeight},a.current.interimBuffer.push(e),a.render(e))},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)},destory:function(){}};var n=window.vm||{};n.module=n.module||{},n.module.rectangle=e,window.vm=n}()},{}],8:[function(e,t,n){!function(){function e(e){this.name=e.name||"Round",this.interimBuffer=[],this.points=[],this.buffer=[]}var t={circle:0,roundel:1,ellipesstroke:2,ellipes:3};e.prototype={constructor:e,active:function(){},bufferRender:function(e,n){var a=this;if(n)a.current.points=[],a.current.points.push(e.x),a.current.points.push(e.y);else{var i=[],o=a.current.points[0],r=a.current.points[1],c=t[a.current.name],l=e.x-o,s=e.y-r;i.push((o+e.x)/2),i.push((r+e.y)/2),0===c||1===c?i.push(Math.abs(l)>Math.abs(s)?Math.abs(l)/2:Math.abs(s)/2):(i.push(Math.abs(l)/2),i.push(Math.abs(s)/2)),a.current.interimBuffer.pop(),e={type:"round",data:i,status:0,mode:c,origin:!0,color:a.params.color,from:a.params.id,width:a.mainCanvas.offsetWidth,height:a.mainCanvas.offsetHeight},a.current.interimBuffer.push(e),a.render(e)}},render:function(){var e=this.current.interimBuffer.shift();if(e)do{e.status=1,this.current.buffer.push(e),this.render(e),e=this.current.interimBuffer.shift()}while(e)},destory:function(){}};var n=window.vm||{};n.module=n.module||{},n.module.round=e,window.vm=n}()},{}],9:[function(e,t,n){!function(){function e(e){this.name=e.name||"Text",this.interimBuffer=[],this.points=[],this.buffer=[]}e.prototype={constructor:e,active:function(){},bufferRender:function(e,t){var n=this;t&&(n.current.points=[],n.current.points.push(e.x),n.current.points.push(e.y),n.textInput.style.cssText="visibility: visible; z-index: 101; font-size: "+n.params.fontSize+"; left: "+(e.x+n.mainCanvas.offsetLeft)+"px; top: "+(e.y+n.mainCanvas.offsetTop-n.textInput.offsetHeight/2-18)+"px",n.textInput.focus(),e={type:"text",data:[e.x,e.y],status:0,origin:!!t,color:n.params.color,size:n.params.fontSize,from:n.params.id,width:n.mainCanvas.offsetWidth,height:n.mainCanvas.offsetHeight},n.current.interimBuffer.push(e))},render:function(e){if("[object String]"==Object.prototype.toString.call(e)&&(e=e.replace(/^\s*|\s*$/,""))){var t=this,n=t.current.interimBuffer.pop();n&&(n.data.push(e),t.textInput.value="",t.textInput.removeAttribute("style"),n.status=1,t.current.buffer.push(n),t.render(n),t.current.interimBuffer.length=0)}},destory:function(){var e=this,t=e.textInput.value.replace(/^\s*|\s*$/,"");t&&e.current.render.call(e,t),e.textInput.value="",e.textInput.removeAttribute("style")}};var t=window.vm||{};t.module=t.module||{},t.module.text=e,window.vm=t}()},{}]},{},[1,2,3,5,6,7,8,9,4])}]);